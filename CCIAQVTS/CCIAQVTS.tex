% === Revtex Declaration ===
\documentclass[aps, 10pt, english, twoside, pra, nofootinbib, tightenlines, longbibliography, superscriptaddress]{revtex4-1}

% === All of the Packages I use frequently ===
\usepackage{packages/document_config}

% === Causal structure formatting for tikz ===
\input{figures/causal_structures/formatting}

\begin{document}
    \title{Causal Compatibility Inequalities Admitting of Quantum Violations in the Triangle Structure}
    \author{Thomas C. Fraser}
    \email{tfraser@perimeterinstitute.ca}
    \affiliation{Perimeter Institute for Theoretical Physics, Waterloo, Ontario, Canada, N2L 2Y5}
    \affiliation{University of Waterloo, Waterloo, Ontario, Canada, N2L 3G1}
    \author{Elie Wolfe}
    \affiliation{Perimeter Institute for Theoretical Physics, Waterloo, Ontario, Canada, N2L 2Y5}
    % \email{ewolfe@perimeterinstitute.ca}
    \date{\today}
    \begin{abstract}
        It has long been recognized that certain quantum correlations are incompatible with particular assumption about classical causal structure. Given a causal structure of unknown classicality, the presence of such correlations certifies the non-classical nature of the causal structure in a device independent fashion. In structures where all parties share a common resource, these non-classical correlations are also known as non-local correlations. Any constraint satisfied by all correlations which \textit{are} classically compatible with a given causal structure defines a causal compatibility criterion. Such criteria were recently derived for the Triangle structure [\href[pdfnewwindow]{http://arxiv.org/abs/1609.00672}{arXiv:1609.00672}] in the form of polynomial inequalities, begging the question: do any of those inequalities admit violation by quantum correlations? Numerical investigation suggests not, and we further conjecture that the set of correlations admitted by the classical Triangle structure is equivalent to the set of correlations admitted by its quantum generalization whenever the three observable variables are binary. Our main contribution in this work, however, is the derivation of new causal compatibility inequalities for the Triangle structure which \textit{do} admit quantum violation. This provides the first robust-to-noise witness of quantum correlations in the Triangle structure. We conclude by considering the possibility of quantum resources potentially qualitatively different from those known previously.
    \end{abstract}
    \maketitle
    % \tableofcontents
    % \setlength{\parskip}{1em}

    \section{Introduction}
    \label{sec:introduction}
    In recent decades, the technical utility of quantum mechanics has become abundantly clear. In the realm of computation, quantum algorithms --- such as Shor's algorithm~\cite{Shor_1997} and numerous others~\cite{Jordan_2016} --- scale exponentially better than their classical counterparts. In the realm of secure communication, quantum protocols --- a popular example being Quantum Key Distribution~\cite{Bennett_2014} --- are able to provide privacy even against hypothetical adversaries with unlimited computational power, a desideratum which classical protocols are unable to fulfill. Throughout history, every aspect of quantum phenomena which fails to be emulated by classical resources has led to a practical exploitation of the non-classical feature in order to solve a some computational of communicational problem~\cite{Neilsen_Chaung_2011}. Motivated by past successes, a primal objective of modern quantum information theory is the discovery of new situations wherein quantum mechanics offers an advantage, and certification that the quantum advantage is genuine.

    From a foundational prospective, the most robust demonstrations of quantum phenomena with no classical emulation have involved Bell inequalities~\cite{Bell_1964,Brunner_2013}. Originally, Bell inequalities were derived as a way to show that no hidden variable theory could ever account for quantum mechanics; in this sense Bell inequalities are a response to the famous EPR paradox~\cite{EPR_Orig}. The enumeration of Bell inequalities has since become a widespread systematic way of demonstration the \textit{non-classicality} of a given observation. More recently it has been appreciated that Bell inequalities can understood as consequences of \term{causal inference}~\cite{Wood_2012}. Causal inference is concerned with classifying observations into those which can and cannot be explained by a hypothesized causal structure. The abstract nature of causal inference is responsible for its presence in numerous scientific fields including machine learning and biology~\cite{Pearl_2009,Pearl_2009_tr}. Causal compatibility inequalities, such as Bell and Instrumental inequalities \cite{pearl1995instrumental,bonet2001instrumental,evans2012graphical}, characterize the space of observations that are compatible with a hypothesized causal structure, albeit the characterization offered by practically derivable inequalities is often only an approximation. To derive the traditional Bell inequalities from causal inference one starts with a (classical) causal structure known as the Bell structure, as depicted in \cref{fig:bell_structure}. The fundamental Bell structure involves non-communicating parties making measurements on some hidden shared resource $\la$, where the measurement outcomes ($A, B$) are presumed to be stochastic functions of the the local choices of measurement settings ($S_A, S_B$) and the shared resource $\la$. Quantum non-classicality in the Bell structure has been thoroughly studied since Bell's original work~\cite{Brunner_2013}. More complex structures, however, such as the correlation scenarios proposed by Fritz~\cite{Fritz_2012,Fritz_2014}, are much less understood. Here we investigate one particular correlation scenario named the Triangle structure (\cref{fig:triangle_structure}).

    The Triangle structure (\cref{fig:triangle_structure}) is a causal structure comprised of $3$ parties labeled $A, B, C$ arranged in a triangular configuration while pair-wise sharing hidden/latent variables $X, Y, Z$. It has been extensively studied previously (see~\cite[Fig. 1]{Steudel_2010},~\cite[Fig. 6]{Chaves_2014},~\cite[Fig. 8]{Branciard_2012},~\cite[Fig. 8, App. E]{Henson_2014},~\cite[Fig. 3]{Fritz_2012},~\cite[Fig. 4]{Weilenmann_2016},~\cite[Fig. 1]{Inflation}, $\ldots$). An overview of some milestone results is provided in \cref{sec:triangle_structure}. Identifying causal compatibility inequalities for this configuration has been seen as particularly challenging~\cite{Branciard_2012}. Further identifying causal compatibility inequalities of such high resolution that such inequalities can be violated by quantum-accessible distributions has remained out-of-reach for the Triangle structure.

    This work is the first, therefore, to find causal compatibility inequalities for the Triangle structure that are able to be violated by quantum-accessible distributions. This accomplishment was made possible through the combination of two previous developments. First, the insight of \citet{Fritz_2012} regarding the ability to re-interpret the Bell structure as a portion of the Triangle structure. Second, the new framework for solving causal inference problems developed by Wolfe \emph{et al.}~\cite{Inflation} called \term{The Inflation Technique}. Ultimately, this work serves as a validation that the Inflation Technique is sensitive enough to offer new insights into quantum non-classicality \cite{Navascues_2017}. Moreover, these new inequalities offer an avenue for recognizing previously unknown forms of non-classicality. The authors attempts to find such novel resources were met with only partial success, suggesting clear refinements for future exploration.

    The manuscript is organized into the following sections: \Cref{sec:causal_compatibility} recalls important notions from causal inference theory and sets up the notation to be used. \Cref{sec:bell_structure} offers a summary of the popular Bell structure and associated inequalities. \Cref{sec:triangle_structure} discusses the Triangle structure and provides an overview of existing research; identifying its stark differences from the Bell structure and motivating why the Triangle structure is worth studying. \Cref{sec:fritz_distribution} defines and discusses a singularly-quantum correlation first conceived of by \citet{Fritz_2012}, which we term the \term{Fritz distribution}. The Fritz distribution first was proven to be non-classical without the use of inequalities. Here we offer a direct proof using inequalities, with the advantage that our proof is robust to noise. A sample of such inequalities are presented in \cref{sec:found_inequalities}, specifically \cref{eq:ww_ineq,eq:web_inequality,eq:symmetric_web_inequality}. In \cref{sec:violations_noise} we quantify the robustness to noise of the Fritz distribution, and we numerically optimize our derived inequalities over quantum-accessible distributions (using qubits) in an effort to seek out new new flavors of non-classicality in the Triangle structure. Additionally, the Fritz distribution is subjected to noise in order to measure the robustness of the derived inequalities. \Cref{sec:conclusions} concludes with proposed avenues for further research.

    \Cref{sec:inflation_technique_summary} briefly summaries the Inflation Technique in the specific context of this work. Although the summary presented in \Cref{sec:inflation_technique_summary} is designed to be self-standing, a much more pedagogical introduction is offered by the original work~\cite{Inflation}. \Cref{sec:deriving_inequalities} demonstrates how the Inflation Technique was used to derive the causal compatibility inequalities for the Triangle structure which admit violation by quantum-accessible distributions.

    \section{Causal Compatibility}
    \label{sec:causal_compatibility}
    The task of causal inference is to determine the set of potentially observable probability distributions compatible with some hypothesis about causal relationships~\cite{Pearl_2009}. If an observed distribution can be explained by the hypothesized causal mechanism, then the distribution is said to be \textit{compatible} with said causal mechanism. In order to define compatibility rigorously, we first need to formally define the notion of a causal hypothesis.

    A hypothesis of causal mechanism is formally referred to as a \term{causal structure} and can be represented as a \term{directed acyclic graph}. A directed graph $\graph$ is an ordered tuple $\br{\nodes, \edges}$ of respectively \textit{nodes} and \textit{edges} where each edge $e \in \edges$ connects a \textit{pair} of nodes $n, m \in \nodes$ with a directed arrow $e = \bc{n \to m}$. A directed graph is \textit{acyclic} if there are no paths following the directions of the edges starting from and returning to the same node. The nodes $\nodes$ of a causal structure represent random variables while the edges $\edges$ represent a casual influence from one variable to another pursuant to the prescribed direction.

    Henceforth, we will utilize a number of familiar notions from graph theory and denote them accordingly. The \term{parents of a node} $n \in \nodes$ are all nodes which point directly into $n$, i.e. $\Pa[\graph]{n} \defined \bc{m \mid m \to n}$. Similarly defined are the \term{children of a node} $\Ch[\graph]{n} \defined \bc{m \mid n \to m}$. Recursively defined are the \term{ancestors of a node} $\An[\graph]{n} \defined \bigcup_{i\in\mathbb{N}} \Pa[\graph][i]{n}$ where $\Pa[\graph][i]{n} \defined \Pa[\graph]{\Pa[\graph][i-1]{n}}$ and $\Pa[\graph][0]{n} = n$ and the \term{descendants of a node} $\De[\graph]{n} \defined \bigcup_{i\in\mathbb{N}} \Ch[\graph][i]{n}$ where $\Ch[\graph][i]{n} \defined \Ch[\graph]{\Ch[\graph][i-1]{n}}$ and $\Ch[\graph][0]{n} = n$. Finally, we extend this notation to a subset of nodes $N \subseteq \nodes$ by performing a union over elements. As an example, the parents of the nodes $N \subseteq \nodes$ are denoted $\Pa[\graph]{N} = \bigcup_{n \in N} \Pa[\graph]{n}$.

    % A number of causal structures are depicted throughout this document (see \cref{fig:bell_structure,fig:triangle_structure,fig:inflations}). As an example, the Triangle structure has $3$ observable nodes and $3$ latent nodes,
    % \[ \nodes_{O} = \bc{A, B, C} \qquad \nodes_{L} = \bc{X, Y, Z} \]
    % along with $6$ edges indicating that the latent nodes $\bc{X, Y, Z}$ cause and influence the observed nodes $\bc{A, B, C}$.
    % \[ \edges = \bc{\bc{X \to A}, \bc{Y \to A}, \bc{Y \to B}, \bc{Z \to B}, \bc{Z \to C}, \bc{X \to C}} \]

    Let us now formalize the notion of compatibility between a causal structure $\graph$ and a probability distribution $\prob[\nodes]$ defined over the nodes of $\graph$. Intuitively, the absence of certain causal connections within $\graph$ should limit the set of possible observations that can be made on $\graph$. Specifically, the causal structure $\graph$ hypothesizes that if each variable $n \in \nodes$ is causally influenced by its parents $\Pa[\graph]{n}$. Therefore, if each variable is conditioned on its parentage, the probability distribution $\prob[\nodes]$ should factorize accordingly:
    \[ \prob[\nodes] = \prod_{n \in \nodes} \prob[n \mid \Pa[\graph]{n}] = \prob[n_1 \mid \Pa[\graph]{n_1}] \times \cdots \times \prob[n_k \mid \Pa[\graph]{n_k}] \eq \label{eq:compatibility_as_factorization}\]
    % , except its own descendants when conditioned over $\Pa[\graph]{n}$. This is known as the \term{local Markov property}:\footnote{Here $A \indep B \mid C$ denotes statistical independence between $A$ and $B$ conditional on $C$ where $A,B,C \subseteq \nodes$, i.e. for a given probability distribution $\prob[\nodes]$, $\prob[AB \mid C] = \prob[A \mid C]\prob[B \mid C]$.}
    % \[ n \indep \br{\nodes \setminus \De[\graph]{n}} \mid \Pa[\graph]{n} \quad \forall n \in \nodes \eq \label{eq:local_markov_property} \]
    If a given distribution $\prob[\nodes]$ defined over \textit{all} of the nodes $\nodes$ of $\graph$ satisfies \cref{eq:compatibility_as_factorization}, then $\prob[\nodes]$ is said to be \term{compatible with $\graph$}. The conditional distributions in \cref{eq:compatibility_as_factorization} (i.e. $\{\prob[n \mid \Pa[\graph]{n}] \mid n \in \nodes\}$) are referred to as a set of \term{causal parameters for $\graph$}. If a distribution $\prob[\nodes]$ cannot be factorized according to \cref{eq:compatibility_as_factorization}, $\prob[\nodes]$ is said to be \term{incompatible} with $\graph$.
    % The compatibility of a distribution $\prob[\nodes]$ with a causal structure $\graph$ pursuant to \cref{eq:compatibility_as_factorization} is equivalent to the requirement that $\prob[\nodes]$ obeys all of the conditional independence constraints implied by the \textit{d-separation relations} between variables/nodes in $\graph$~\cite{Pearl_2009}.
     When one is specified with a joint distribution $\prob[\nodes]$ defined over all nodes of a causal structure $\graph$, it is possible to completely determine whether or not $\prob[\nodes]$ is compatible with $\graph$ by computing the causal parameters induced by $\prob[\nodes]$ and checking the equality of \cref{eq:compatibility_as_factorization}.

    A challenge, however, is presented when one is supplied with a partial observation, i.e. a joint distribution $\prob[\nodes_{O}]$ where $\nodes_{O} \subset \nodes$ is some subset of variables referred to as the \term{observable nodes} $\nodes_O$. In such cases, $\prob[\nodes_{O}]$ does not induce a unique set of causal parameters for $\graph$ and \cref{eq:compatibility_as_factorization} can not be verified by direction calculation. Instead, compatibility between $\graph$ and $\prob[\nodes_{O}]$ depends on the existence or non-existence of a set of causal parameters for $\graph$ such that $\prob[\nodes_{O}] = \prod_{n \in \nodes_{O}} \prob[n \mid \Pa[\graph]{n}]$. The complementary, unobservable nodes are termed \term{latent nodes} $\nodes_L = \nodes \setminus \nodes_{O}$, and should be understood as hidden random variables that are unknowable either by some fundamental process or cannot be measured due to other limitations.


    There are several approaches to tackling the compatibility problem when dealing with latent variables; there are two common approaches worth mentioning here. The first is to recognize that many equality constraints are implied by the causal structure, including conditional independence relations and so-called Verma constraints among others; see Refs. \cite{evans2015margins,evans2017markov} for thorough treatments. The failure to satisfy an equality constraint immediately disqualifies $\prob[\nodes_{O}]$ from being compatible with $\graph$. Equality constraints are easily derived given a causal structure, and checking equality-constraints satisfaction is the minimalistic algorithm which powers the overwhelming majority of practical causal inference hypothesis testing in the fields of machine learning and artificial intelligence. In quantum theory, however, we require strong, more sensitive, causal inference techniques. This is because the equality constraints satisfied by classical correlations (compatible with some classical causal structure) are also all satisfied by quantum correlations (generated by the quantumified causal structure in which latent variables are replaced with shared entanglement) \cite{Henson_2014}.
    Our focus, therefore, in on deriving \emph{inequality} constraints (over $\prob[\nodes_{O}]$ and its marginals) implied by a causal structure, which we term \term{causal compatibility inequalities}\footnote{We refer to these inequalities as ``causal compatibility inequalities'' instead of Bell inequalities for two reasons. Firstly, ``Bell inequalities'' usually are associated specifically with the Bell structure. Secondly, the inequalities derived in this work are fundamentally distinct from a typical Bell inequality in that these inequalities are \textit{polynomial} over $\prob[\nodes_{O}]$ instead of \textit{linear}.}. For some causal structures, the equality constraints associated with it are sufficient to perfectly characterize the distributions genuinely compatible with it; for others, however, inequality constraints are also important. Causal structures for which inequality constraints are relevant have been termed \textit{interesting}~\cite{Henson_2014}, and such structures include the Instrumental structure, the Bell structure, and the Triangle structure studied here, among infinitely many others.
    Herein we use the Inflation Technique~\cite{Inflation} to find causal compatibility inequalities; \Cref{sec:inflation_technique_summary} discusses the Inflation Technique as applied in this work.

    If a probability distribution $\prob[\nodes_{O}]$ happens to \textit{violate} any causal compatibility inequality, then that distribution is deemed \textit{incompatible}.  Conversely, a singular inequality can only be used to prove that a given distribution is \textit{incompatible}; a single inequality cannot certify compatibility. A \textit{complete characterization} of compatibility consists of a complete set of all valid causal compatibility inequalities such that satisfaction of the entire set certifies compatibility. Currently however, it is unknown how to obtain a complete characterization for any given causal structure, including the Triangle structure.

    From the perspective of identifying quantum non-classicality, a causal structure $\graph$ adopts the role of a classical hypothesis. Therefore, non-classicality becomes synonymous with incompatibility: if a distribution $\prob[\nodes_{O}]$ is incompatible, then it is non-classical. Henceforth, we will use these two terms interchangeably. From a resource standpoint, if the non-classicality of $\prob[\nodes_{O}]$ with $\graph$ can be witnessed by an inequality $I$, but nevertheless $\prob[\nodes_{O}]$ can be implemented using quantum states and measurements while otherwise respecting the causal relations of $\graph$, then the causal compatibility inequality $I$ represents a task or game where quantum resources out-perform classical resources relative to $\graph$.

    \section{Bell Structure}
    \label{sec:bell_structure}
    This section aims to define the Bell causal structure and to review some of the traditional witnesses used to asses the classicality (or lack thereof) of distributions relative to it. The purpose of this section is to equip readers with the pertinent background and also to draw comparisons between the advancements made toward understanding non-classicality of the Bell structure versus analogous results obtained for Triangle structure later in this work.

    The bipartite Bell structure (\cref{fig:bell_structure}) refers to an iconic causal structure involving two distant parties who observe the outcomes of local measurements as random variables $A (B)$ determined by their individual measurement settings $S_A (S_B)$, and where the parties are also presumed to be commonly informed by some shared latent resource $\la$~\cite{Brunner_2013}. The resulting observable correlations hence naturally form a conditional probability distribution $\prob[AB|S_AS_B]$. Subject to the notions of compatibility presented in \cref{sec:causal_compatibility}, $\prob[A|S_A,\la]$ is compatible with \cref{fig:bell_structure} if and only if there exists some functional specification of $\la$ and causal parameters $\prob[A|S_A,\la]$, $\prob[B|S_B,\la]$ such that\footnote{Here the summation $\sum_{\la}$ is used to denote a statistical marginalization over the latent variable $\la$ with unspecified support.}
    %    there exists a distribution $\prob[AB|S_AS_B,\la]$ such that $\prob[AB|S_AS_B] = \sum_{\la} \prob[AB|S_AS_B,\la]$ and also satisfies the following implementation of \cref{eq:compatibility_as_factorization}:
    \begin{align}\label{eq:bellcompat}
     \prob[AB|S_AS_B] \text{ is classically compatible with \cref{fig:bell_structure}} \quad\iff \quad \prob[AB|S_AS_B] = \sum_{\la} \prob[A|S_A,\la]\prob[B|S_B,\la]\,.
    \end{align}

    Any observed distribution $\prob[AB|S_AS_B]$ which fails to be explained by the classical causal hypothesis of the Bell structure as defined by \cref{eq:bellcompat} is appropriately termed non-classical. Often, distributions incompatible with the Bell structure are referred to as non-local because the Bell structure markedly lacks causal influence from one party to another. In particular,~\citet{Bell_1964} demonstrated that there exists distributions that are non-classical yet are attainable via local measurements on a shared quantum resource.
    %If one does not wish to accept fine-tuning arguments, one must accept that quantum correlations can be non-local as no variation to the latent nodes can explain the same correlations~\cite{Wood_2012}.\footnote{This is unlike the Triangle structure wherein a global yet latent common cause is always an acceptable explanation for any correlation and does require fine-tuning. Therefore, we never refer to non-classical correlations in Triangle Structure as non-local.}

    Let us now contrast now the classical definition of compatibility with its quantum generalization. Quantum correlation arise from a quantumified version of the causal structure, in which latent variables are replaced with quantum systems. Concretely, a distribution is accessible with quantum resources and measurements for the quantumified Bell structure if and only if there exists a bipartite quantum state $\rho_{AB}$ of arbitrary dimension, as well as Hilbert-space-localized measurement sets $M_{A|S_A}, M_{B|S_B}$\footnote{Note that a measurement set $M_{A} = \bc{M_{A}^{1}, M_{A}^{2}, \ldots, M_{A}^{k}}$ services a shorthand notation in the following sense, $\prob[A] = \Tr\bs{\rho M_{A}} \implies \prob[A]\br{a} = \Tr\bs{\rho M_{A}^{a}}$.} with indices conditional upon the measurement settings, such that
    \begin{align}\label{eq:bellQcompat}
    \prob[AB|S_AS_B] \text{ is a quantum realization of \cref{fig:bell_structure}} \quad\iff\quad\prob[AB|S_AS_B] = \Tr\bs{\rho_{AB}M_{A|S_A}\otimes M_{B|S_B}}\,.
    \end{align}
    The non-classicality of quantum distributions for the Bell structure can be demonstrated through the use of Bell inequalities which constrain the correlations between binary variables $A$ and $B$ for classically compatible distributions. A notable example is the CHSH inequality (\cref{eq:CHSH_ineq_orig})~\cite{CHSH_Original}.
    \[ \ba{AB | S_{A} = 0, S_{B} = 0} + \ba{AB | S_{A} = 0, S_{B} = 1} + \ba{AB | S_{A} = 1, S_{B} = 0} - \ba{AB | S_{A} = 1, S_{B} = 1} \leq 2 \eq \label[ineq]{eq:CHSH_ineq_orig} \]
    Non-trivial Bell inequalities such as the CHSH inequality are capable of witnessing the non-classical nature of quantum distributions; the inequalities presented in \cref{sec:found_inequalities} are also of this type. Equality constraints, as previously mentioned, never have that sort of high-resolution discernment sensitivity.

    % Finally, must like any causal structure, Bell inequalities act as a measure of the non-classical character of a given distribution. In particular, the antecedent of \cref{eq:CHSH_ineq_orig} has a classical upper-bound of $2$ and it can be shown to have a quantum upper-bound of $2\sqrt{2}$~\cite{Cirelson_1980}. Furthermore, non-classical distributions that are also non-quantum such as the PR-box correlations are upper-bounded by $4$~\cite{PR_1995}. In \cref{sec:found_inequalities}, newly discovered and analogous inequalities for the Triangle structure are presented. Although their associated quantum and post-quantum upper-bounds are currently unknown, an attempt to numerical compute these is discussed in \cref{sec:optimizations}.

    \begin{figure}
    \begin{nscenter}
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \scalebox{1.0}{\input{figures/causal_structures/bell_scenario}}
            \caption{The Bell structure consisting of two observers $A, B$ together with measurement settings $S_{A}$ and $S_{B}$ respectively. The shared latent variable is labeled $\la$.}
            \label{fig:bell_structure}
        \end{minipage}\hspace{0.04\textwidth}%
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \scalebox{1.0}{\input{figures/causal_structures/triangle_structure}}
            \caption{The Triangle structure consisting of three observable variables $A,B,C$ and three latent variables $X, Y, Z$.}
            \label{fig:triangle_structure}
        \end{minipage}
    \end{nscenter}
    \end{figure}


    \section{Triangle structure}
    \label{sec:triangle_structure}

    As was mentioned in \cref{sec:introduction,sec:causal_compatibility}, the \term{Triangle structure} (\cref{fig:triangle_structure}) is a causal structure $\graph$ consisting of $3$ observable variables $A, B, C$ arranged in a triangular configuration while pair-wise sharing latent variables $X, Y, Z$.
    %Here we lay out the task for discovering quantum non-classicality in the Triangle structure.
    Following the definition of causal compatibility from \cref{sec:causal_compatibility}, a distribution $\prob[\nodes_{O}] = \prob[ABC]$ is compatible with the Triangle structure if and only if there exists a choice of causal parameters $\bc{\prob[A|X,Y],\prob[B|Y,Z],\prob[C|Z,X],\prob[X],\prob[Y],\prob[Z]}$ such that
    %the joint distribution $\prob[\nodes] = \prob[ABCXYZ]$ is a product over the causal parameters,
    %\[ \prob[ABCXYZ] = \prob[A|X,Y]\prob[B|Y,Z]\prob[C|Z,X]\prob[X]\prob[Y]\prob[Z] \]
    %And also, the given distribution
    $\prob[ABC]$ is a marginalization of $\prob[ABCXYZ]$ over $X, Y, Z$\footnote{Here the summation $\sum$ is used to denote a statistical marginalization over the latent variables $X,Y,Z$ with unspecified support.}, i.e.
    \[ \prob[ABC] \text{ is classically compatible with \cref{fig:triangle_structure}} \quad\iff\quad\prob[ABC] = \sum_{X,Y,Z}\prob[A|X,Y]\prob[B|Y,Z]\prob[C|Z,X]\prob[X]\prob[Y]\prob[Z]\,. \eq \label{eq:triangle_compatibility} \]
    By contrast, the quantum realization of the Triangle structure are defined with substantially greater freedom, namely
    \[ \prob[ABC] \text{ is a quantum realization of \cref{fig:bell_structure}} \quad\iff\quad\prob[ABC] = \Tr\bs{\netperm^\intercal \rho_{AB}\otimes\rho_{BC}\otimes\rho_{CA} \netperm M_{A}\otimes M_{B} \otimes M_{C}}\,, \eq \label{eq:triangle_Qcompatibility} \]
    where $\rho_{AB}, \rho_{BC}, \rho_{CA}$ are bipartite density matrices, $M_{A}, M_{B}, M_{C}$ are generic measurements sets, and $\netperm$ is a permutation matrix to align the states and measurements appropriately.
    %For certain causal structures, the conditional independence relations provided by $d$-separation relations are a sufficient characterization of compatibility. Recently, \citet{Henson_2014}, classified the Triangle structure as an \textit{interesting} causal structure in the sense that conditional independence relations \textit{do not} provide a sufficient characterization of non-classicality.\footnote{Note that the Triangle structure possesses \textit{zero} conditional independence relations over the observable nodes $A, B, C$.} Moreover,
    The Triangle structure serves as an excellent test case for furthering our understanding of quantum non-classicality in network causal structures. It maintains superficial simplicity (only three observable variables) while introducing many challenging features not found in the study of the Bell structure.
    For example, the spaces of both classical and quantum distributions on the Triangle structure are non-convex \cite{Fritz_2012,Inflation}, unlike for the Bell structure. The convexity of the Bell structure's distributions is arguably responsible for the wealth of knowledge about it, including its complete characterization of classicality \cite{Brunner_2013}.
    Importantly, \citet{Fritz_2012} explicitly demonstrated of existence of (at least) one incompatible-but-quantum distribution for the Triangle structure, so its known to possess quantum non-classicality. It seems reasonable to assume that quantum non-classicality in the Triangle structure should be translatable into a computational advantage for certain computational circuits~\cite{Terhal_2002}; novel instances of non-classicallity are expected to correspond to novel information-theoretical quantum advantages. A fundamental limitation of Fritz's proof of non-classicality, however, is that it does not involve causal compatibility inequalities, and hence does not advance our repertoire of inequality constraints for the Triangle structure.
    Some inequality constraints for the Triangle structure have been derived in previous works. For example, \citet{Steudel_2010} derived an inequality distinguishing the distributions compatible with the Triangle structure from those compatible with structures in which all the observable variables share a common latent ancestor. \citet{Henson_2014} derived a family of entropic inequalities for the Triangle structure, which was the expanded somewhat by \citet{Weilenmann_2016}. Recently, \citet{Inflation} derived a variety of new, especially sensitive, polynomial causal compatibility inequalities for the Triangle structure. In particular, the inequalities of Ref. \cite{Inflation} expose a previously unclassified (as assessed by all formerly known constraints) distribution called the $w$-distribution\footnote{Although the $w$-distribution is non-classical, it is also non-quantum. The non-quantum nature of the $w$-distribution has been demonstrated by Miguel Navascués and Elie Wolfe in private correspondence.} as incompatible with the Triangle structures.
    Remarkably, \emph{none} of the existing causal compatibility inequalities for the Triangle structure were known to admit violation by any quantum distribution. That is to say, it was unknown if any inequality known for the Triangle structure might be useful for distinguishing quantum distributions from their classical counterparts. In \Cref{sec:preliminary_research} we report on attempts to utilize these inequalities to search for incompatible distributions that are also quantum-accessible. The subsequent failure of these approaches effectively motivates the remainder of this work.
    In summary, the Triangle structure is a desirable case study because it is known to admit non-classical distributions using quantum resources, but yet no inequality heretofore could separate its classical distributions from its quantum distributions. This failure represents a gap in our understanding of quantum non-classicality and prompts the discovery of \textit{new} inequalities.

    \section{Fritz Distribution}
    \label{sec:fritz_distribution}
    \begin{figure}
    \begin{nscenter}
        \scalebox{1.0}{\input{figures/causal_structures/triangle_structure_operational_fritz_bell}}
        \caption{The Triangle structure re-imagined to mimic the Bell structure. The measurement settings $S_{A},S_{B}$ are latent nodes unlike the Bell structure (\cref{fig:bell_structure}).}
        \label{fig:triangle_structure_with_fritz_bell_embedded}
    \end{nscenter}
    \end{figure}

    As first realized by \citet{Fritz_2012}, one may construct quantum distributions incompatible with the Triangle structure by recasting quantum distributions incompatible with the familiar Bell structure into a settings-free tripartite format. To explain, imagine rearranging the Triangle structure into the configuration depicted in \cref{fig:triangle_structure_with_fritz_bell_embedded} so that it closely resembles the Bell structure (\cref{fig:bell_structure}). Evidently, under the correct relabeling, large portions of the Triangle structure resemble the Bell structure. The crucial distinction is that $S_{A}, S_{B}$ are random variable representing the recorded measurement \emph{settings} in the Bell structure whereas those $S_{A}, S_{B}$ are \emph{latent} variables in in the Triangle structure, which get reported as \textit{auxiliary outcomes} for Alice and Bob.

    The analysis of non-classicality changes, however, when $S_{A}, S_{B}$ are not freely chosen by the observers but rather by a process outside of the individual party's control. Relaxing the assumption of measurement independence opens up a possible loophole, namely the possibility that the auxiliary outcomes $S_{A}, S_{B}$ of Alice and Bob might be manipulated via dependence on their shared latent variable $\lambda$. We close this loophole by having the third party in the Triangle structure, Charlie, \emph{also} report the latent variables $S_{A}, S_{B}$ as a multivariate outcome. In this manner, the perfect correlation of $C$'s record of $S_{A}, S_{B}$ with the records of $S_{A}$ reported by $A$ and of $S_{B}$ reported by $B$ testifies to the independence of $S_{A}, S_{B}$ from $\lambda$. Consequently, any distribution over $A, B, S_{A}, S_{B}$ that is incompatible with Bell structure is also incompatible with the Triangle structure provided that $C$ is \textit{perfectly correlated} with $S_{A}, S_{B}$~\cite{Fritz_2012}.

    The exemplifying quantum distribution corresponding to a recasting of a non-classical Bell structure distribution into the Triangle structure is the \term{Fritz distribution}~\cite{Fritz_2012}. In the Fritz distribution, denoted $\prob[\fritz]$, each of the variables $A,B,C$ is taken to have $4$ possible outcomes $\bc{0,1,2,3}$. It is convenient to represent the outcomes using two binary digits, $\bc{00,01,10,11}$. Explicitly, $\prob[\fritz]$ can be written as:
    \begin{align*}
    \eq \label{eq:fritz_dist}
    \begin{split}
        \prob[\fritz][000] = \prob[\fritz][110] = \prob[\fritz][021] = \prob[\fritz][131] = \prob[\fritz][202] = \prob[\fritz][312] = \prob[\fritz][233] = \prob[\fritz][323] &= \f{1}{32}\br{2 + \sqrt{2}} \\
        \prob[\fritz][010] = \prob[\fritz][100] = \prob[\fritz][031] = \prob[\fritz][121] = \prob[\fritz][212] = \prob[\fritz][302] = \prob[\fritz][223] = \prob[\fritz][333] &= \f{1}{32}\br{2 - \sqrt{2}}
    \end{split}
    \end{align*}
    Here the notation $\prob[\fritz][abc] = \prob[ABC][abc] = \prob[][A\mapsto a,B\mapsto b,C\mapsto c]$ is used as shorthand. The Fritz distribution is quantum-accessible in the sense that $\prob[\fritz]$ can be implemented using a set of quantum states $\rho_{AB}, \rho_{BC}, \rho_{CA}$ and measurements $M_A, M_B, M_C$ realized on \cref{fig:triangle_structure} using \cref{eq:triangle_Qcompatibility}.
    The Fritz distribution may be visualized as a $4 \times 4 \times 4$ grid of possible outcomes as depicted in \cref{fig:fritz_distribution_visualized}. From this diagram, it can be seen that each of $C$'s outcomes restricts the possible outcomes for $A,B$ into a $2 \times 2$ block. When expressing the outcomes as pairs of binary digits, it can be seen that the left-hand bits for $A$ and $B$ (respectively denoted $A_l$, $B_l$) are fixed by (i.e. perfectly correlated with) the outcome of $C$. Pursuant to the embedding of~\cref{fig:triangle_structure_with_fritz_bell_embedded}, the left-hand bits $A_l$ and $B_l$ emulate the measurement settings $S_{A}$ and $S_{B}$, whereas the right-hand bits $A_r$ and $B_r$ emulate the outcomes which would be obtained by $A$ and $B$ back in the Bell structure (\cref{fig:bell_structure}). Critically, $C$'s bits are perfectly correlated with the left-bits of $A,B$; $C_l = A_l$ and $C_r = B_l$.
    \begin{figure}
    \begin{nscenter}
            \includegraphics[scale=0.6]{figures/distributions/fritz_dist_plotted_bits.pdf}
            \vspace{-0.2in}
            \[ \probplotvalue{253, 253, 84} = \f{1}{32}\br{2 - \sqrt{2}} \qquad \probplotvalue{11, 1, 0} = \f{1}{32}\br{2 + \sqrt{2}}\]
            \caption{The Fritz distribution visualized using a $4 \times 4 \times 4$ grid. The $4$ outcomes of $A,B,C$ are written in binary as a doublet of bits to illustrate that certain bits act as measurement pseudo-settings.}
            \label{fig:fritz_distribution_visualized}
    \end{nscenter}
    \end{figure}
    Consequently, it is possible to define the correlation $\ba{A_r B_r}$ between the right-hand bits of $A$ and $B$:
    \[ \ba{A_r B_r} = \prob[A_r B_r][00] + \prob[A_r B_r][11] - \prob[A_r B_r][01] - \prob[A_r B_r][10] \eq \label{eq:right_bit_correlations} \]
    Provided that $C$ is perfectly correlated with $A_l$ and $B_l$, any Bell inequality for the Bell structure defined over $A, B, S_{A}, S_{B}$ can be directly converted to an inequality for the Triangle structure by performing the surjective relabeling:
    \begin{align*}
        A_r\leftarrow A\,,\quad
        B_r\leftarrow B\,,\quad
        A_l\leftarrow S_{A}\,,\quad
        B_l\leftarrow S_{B}\,,\quad
        C_l\leftarrow S_{A}\,,\quad
        C_r\leftarrow S_{B}\,.
        \eq \label{eq:fritz_relabelling}
    \end{align*}
    As an example, the famous CHSH inequality (\cref{eq:CHSH_ineq_orig})~\cite{CHSH_Original} is translated into a constraint on the correlation between the right-bits of $A$ and $B$,
    \[ \ba{A_r B_r|C = 00} + \ba{A_r B_r|C = 01} + \ba{A_r B_r|C = 10} - \ba{A_r B_r|C = 11} \leq 2 \eq \label[ineq]{eq:CHSH_intriangle} \]
    Every compatible distribution $\prob[ABC]$ \emph{for which $C$ is perfectly correlated with $A_l,B_l$} must satisfy \cref{eq:CHSH_intriangle}. Substituting $\prob[\fritz]$ into \cref{eq:CHSH_intriangle} yields the traditional maximal quantum violation~\cite{Cirelson_1980}: $3 \br{1/\sqrt{2}} - \br{-1/\sqrt{2}} = 2\sqrt{2} \not \leq 2$. %Therefore, we conclude the Fritz distribution is incompatible with the Triangle structure. Before continuing it is worth noting that \cref{eq:fritz_dist} is non-unique. Nonetheless for concreteness, \cref{eq:fritz_dist} is taken as \textit{the} Fritz distribution throughout this manuscript.

    It is important to understand the domain in which Fritz's proof of incompatibility is valid.  %the details of which can found in the original work~\cite{Fritz_2012}. Specifically, \cref{eq:CHSH_intriangle} only acts as a valid causal compatibility inequality for the Triangle structure if there exists
    The proof relies on the perfect correlation between $C$'s outcomes and the measurement pseudo-settings (left-bits) of $A$ and $B$. For example, if one combines \cref{eq:fritz_dist} with slight uniform noise, what can we say with confidence regarding if the resulting modified distribution is classical or not? At what point does the resultant distribution transition from incompatibility to compatibility? This question is partially answered in \cref{sec:noise}.

    Plainly, $\prob[\fritz]$ is a valid but \textit{manufactured} example. The phenomenology associated with Bell non-locality or Bell incompatibility are well understood; examining these distributions embedded in the Triangle structure offers no additional perspective onto the types of non-classical resources made accessible by quantum mechanics. The goal, therefore, is to find incompatible quantum distributions that are qualitatively different than those previously considered for the Bell structure \cite{Gisin_2017}. Recognizing this, \citet{Fritz_2012} presented the following problem~\cite[Problem 2.17]{Fritz_2012}:

    \term{Fritz's Problem}: Find an example of non-classical quantum correlations in the Triangle structure together with a proof of its non-classicality which does not hinge on Bell’s theorem.

    Fritz's problem is concerned with how to find and recognize non-classical quantum distributions specifically for the Triangle structure. The original proof of non-classicality essentially recycled Bell's theorem, and was limited by the requirement of perfect correlations~\cite{Fritz_2012}. Fritz's problem, as originally stated, does not require that the \emph{type} of non-classicality be novel to the Triangle structure; rather, only that the proof should avoid Bell's theorem. \Cref{sec:preliminary_research} delineates our initial, failed attempts at resolving Fritz's problem; \Cref{sec:found_inequalities} reports our eventual success, via the discovery of new causal compatibility inequalities.

    Though not explicit, we read in the spirit of Fritz's problem a desideratum for the discovery of a truly novel form of non-classicality for the Triangle structure. Such a discovery would presumably lead to an understanding of new advantages of quantum resources in network structures; this related problem has attracted attention and conjecture \cite{Gisin_2017}, but remains open. We attempt to make progress on this problem by leveraging the the new causal compatibility inequalities derived herein, but this effort was plagued by instabilities in our numerical optimization which we have not yet overcome. \Cref{sec:conclusions} discusses these challenges, suggesting concrete targets for future research. \Cref{sec:conclusions} also considers how to best contrast non-classicality across differing causal structures.

    \section{Preliminary Research}
    \label{sec:preliminary_research}

    As a preliminary search for quantum incompatibility in the Triangle structure, we performed numerical optimizations using bipartite qubit density matrices and $2$-outcome POVM measurements against the previously-published compatibility inequalities of Ref.~\cite{Inflation}, as well as against the entropic inequalities of \citet{Henson_2014} (which had also been investigated numerically independently by \citet{Weilenmann_2016}). This preliminary investigation did not yield interesting solutions, as none of those inequalities were violated by any 2-outcome coarse-graining of the Fritz distribution. These early results suggest that there is no quantum-classical gap in the Triangle structure for \textit{two-outcome} measurements, i.e. \cref{eq:triangle_compatibility} and \cref{eq:triangle_Qcompatibility} define identical sets of binary-outcome tripartite distributions.

    Operating under the assumptions that all quantum \emph{non}-classical distributions in the Triangle structure must utilize more than two outcomes in at least one variable, this work expands the gamut of inequalities to optimize against to include inequalities referencing strictly more than two outcomes.

    % Moreover, the existence of the Fritz distribution (\cref{sec:fritz_distribution}) directly demonstrates that quantum-accessible incompatibility exists in the Triangle structure and indirectly proves the existence of causal compatibility inequalities capable of witnessing the non-classicality of the Fritz distribution. The Inflation Technique has been shown to completely solve the classical causal inference problem~\cite{Navascues_2017} --- indicating that these undiscovered inequalities can be generated using sufficiently complex inflations. The 37 inequalities in~\cite{Inflation} were derived using the Spiral inflation (\cref{fig:spiral_inflation}) and their failure motivated us to consider larger inflations such as those in \cref{fig:wagon_wheel_inflation,fig:the_web_inflation}.

    % These incipient insights were sufficient for focusing the search for new inequalities sensitive enough to be violated by the Fritz distribution. \
    % Cref{sec:found_inequalities} reports the discovery of these inequalities which expand on our understanding of non-classicality in the Triangle structure. As a by-product, this research illuminates the advantage in using the Inflation Technique to find inequalities for interesting causal structures in general.

    \section{Triangle Structure Inequalities}
    \label{sec:found_inequalities}

    \Cref{sec:causal_compatibility} introduced the notion of causal compatibility inequalities, and \cref{sec:fritz_distribution} discussed the Fritz distribution ($\prob[\fritz]$) together with the initial inequality-free proof of its incompatibility with the Triangle structure. Heretofore, there were no known causal compatibility inequalities for the Triangle structure that were capable of witnessing the non-classicality of any quantum distributions~\cite{Inflation}. By leveraging the incompatibility of the Fritz distribution~\cite{Fritz_2012} and tools provided by the Inflation Technique~\cite{Inflation}, we have obtained numerous causal compatibility inequalities for the Triangle structure that are violated by the Fritz distribution. A representative trio of these $\prob[\fritz]$-incompatability-witnessing inequalities are presented here: $I\tsb{WagonWheel}$ per \cref{eq:ww_ineq}, notable for its simplicity; $I\tsb{Web}$ per \cref{eq:web_inequality}, which best witnesses the non-clasicality of $\prob[\fritz]$ in the presence of noise; and $I\tsb{SymmetricWeb}$ per \cref{eq:symmetric_web_inequality}, which is symmetric with respect to all permutations of the three parties.

    The methods used to derive these inequalities are largely based on the Inflation Technique~\cite{Inflation}. A summary of the Inflation Technique and other methods used will be deferred to \cref{sec:inflation_technique_summary} where unfamiliar readers will find a succinct yet sufficient presentation of the requisites.
    We emphasize that each of these causal compatibility inequalities independently provides a positive resolution of Fritz's problem. The inequalities are derived without making use of Bell's theorem; rather, they follow from the Inflation Technique's broader perspective on non-classicality as a special case of causal inference.

    \subsection{The WagonWheel Inequality}
    The first causal compatibility inequality chosen for presentation is reported below:
    % \begin{equation*}
    % \begin{gathered}
    %     \eq\label[ineq]{eq:ww_ineq}
    %     I\tsb{WagonWheel} : \\
    %     + P_{ABC}(000)P_{C}(3) - 2P_{ABC}(203)P_{C}(0) - 2P_{ABC}(303)P_{C}(0) - P_{ABC}(003)P_{C}(0) \\
    %     - P_{ABC}(013)P_{C}(0) - P_{ABC}(020)P_{C}(2) - P_{ABC}(022)P_{C}(2) - P_{ABC}(023)P_{C}(0) \\
    %     - P_{ABC}(023)P_{C}(2) - P_{ABC}(030)P_{C}(2) - P_{ABC}(031)P_{C}(2) - P_{ABC}(032)P_{C}(2) \\
    %     - P_{ABC}(033)P_{C}(0) - P_{ABC}(033)P_{C}(2) - P_{ABC}(103)P_{C}(0) - P_{ABC}(113)P_{C}(0) \\
    %     - P_{ABC}(123)P_{C}(0) - P_{ABC}(133)P_{C}(0) - P_{ABC}(200)P_{C}(0) - P_{ABC}(200)P_{C}(1) \\
    %     - P_{ABC}(200)P_{C}(2) - P_{ABC}(200)P_{C}(3) - P_{ABC}(201)P_{C}(0) - P_{ABC}(201)P_{C}(1) \\
    %     - P_{ABC}(201)P_{C}(2) - P_{ABC}(201)P_{C}(3) - P_{ABC}(203)P_{C}(1) - P_{ABC}(203)P_{C}(2) \\
    %     - P_{ABC}(203)P_{C}(3) - P_{ABC}(213)P_{C}(0) - P_{ABC}(223)P_{C}(0) - P_{ABC}(300)P_{C}(0) \\
    %     - P_{ABC}(300)P_{C}(1) - P_{ABC}(300)P_{C}(2) - P_{ABC}(300)P_{C}(3) - P_{ABC}(301)P_{C}(0) \\
    %     - P_{ABC}(301)P_{C}(1) - P_{ABC}(301)P_{C}(2) - P_{ABC}(301)P_{C}(3) - P_{ABC}(302)P_{C}(1) \\
    %     - P_{ABC}(303)P_{C}(1) - P_{ABC}(303)P_{C}(2) - P_{ABC}(303)P_{C}(3) - P_{ABC}(313)P_{C}(0) \leq 0
    % \end{gathered}
    % \end{equation*}
    \begin{equation*}
    \begin{gathered}
        \eq\label[ineq]{eq:ww_ineq}
        I\tsb{WagonWheel} : \\
        +P_{A_{l}B_{l}}(11) -P_{A_{l}B_{l}C_{l}C_{r}}(1111) +P_{A_{l}B_{l}}(00) P_{C_{l}C_{r}}(11) +P_{C_{l}C_{r}}(01) P_{C_{l}C_{r}}(10) \\
        -P_{C_{l}C_{r}}(11) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(000000) -P_{C_{l}C_{r}}(11) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(010100) \\
        -P_{C_{l}C_{r}}(10) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(001001) -P_{C_{l}C_{r}}(10) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(011101) \\
        -P_{C_{l}C_{r}}(01) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(100110) -P_{C_{l}C_{r}}(01) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(110010) \\
        +P_{C_{l}C_{r}}(00) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(101111) +P_{C_{l}C_{r}}(00) P_{A_{l}A_{r}B_{l}B_{r}C_{l}C_{r}}(111011) \\
        \leq 0
    \end{gathered}
    \end{equation*}
    \Cref{eq:ww_ineq} is termed the Wagon Wheel inequality and denoted $I\tsb{WagonWheel}$ after the (identically-named) inflated structure of \cref{fig:wagon_wheel_inflation} used to derive it. To reiterate, a summary of the methods used to derive \cref{eq:ww_ineq} can be found in \cref{sec:marginal_satisfiability,sec:inflation_technique_summary,sec:deriving_inequalities}.
    Aside from increasing outcome cardinality, we are also forced to consider larger inflations than those analyzed in Ref.~\cite{Inflation}. This is because we found the smaller inflations considered there --- such as the Spiral inflation depicted in \cref{fig:spiral_inflation} --- were simply \textit{unable} to witness the incompatibility of the Fritz distribution, even when analyzed explicitly using four possible outcomes for every observable variable.

    By construction, every distribution $\prob[ABC]$ that is compatible with the Triangle structure per \cref{eq:triangle_compatibility} must satisfy $I\tsb{WagonWheel}$. On the other hand, the Fritz distribution violates $I\tsb{WagonWheel}$ with violation $\f{1}{16} \not \leq 0$. Consequently we affirm that the Fritz distribution is incompatible with the Triangle structure, a fact previously only demonstrated without inequalities.

    % \footnote{To aid verification: the first term in \cref{eq:ww_ineq} for the Fritz distribution is $\prob[ABC]\br{000}\prob[C]\br{3} = \f{1}{128}\br{2 + \sqrt{2}} \simeq 0.0267$ while all of the remaining terms sum to $\simeq 0.0136$.}

    % It is possible to simplify $I\tsb{WagonWheel}$ by identifying sets of terms such as $P_{ABC}(300)P_{C}(0) + P_{ABC}(300)P_{C}(1) + P_{ABC}(300)P_{C}(2) + P_{ABC}(300)P_{C}(3)$ which can be simplified to $P_{ABC}(300)$ by recognizing that $P_{C}(0) + P_{C}(1) + P_{C}(2) + P_{C}(3) = 1$. Upon doing so, one obtains an equivalent representation for $I\tsb{WagonWheel}$,

    % \begin{equation*}
    % \begin{gathered}
    % \eq\label[ineq]{eq:ww_ineq_symplified}
    % I\tsb{WagonWheel} : \\
    % + P_{ABC}(000)P_{C}(3) + P_{ABC}(021)P_{C}(2) + P_{ABC}(202) + P_{ABC}(302) + P_{ABC}(233)P_{C}(0) + P_{AC}(33)P_{C}(0) \\
    % - P_{ABC}(303)P_{C}(0) - P_{ABC}(313)P_{C}(0) - P_{ABC}(302)P_{C}(1) - P_{AB}(02)P_{C}(2) - \\
    % - P_{AB}(03)P_{C}(2) - P_{AB}(20) - P_{AB}(30) - P_{C}(3)P_{C}(0) \leq 0
    % \end{gathered}
    % \end{equation*}

    % \begin{equation*}
    % \begin{gathered}
    % \eq\label[ineq]{eq:ww_ineq_symplified}
    % I\tsb{WagonWheel} : \\
    % - P_{A_lB_lB_r}(100) \\
    % - P_{C_lC_r}(11)P_{C_lC_r}(00) \\
    % + P_{A_lB_lB_rC_lC_r}(10010) \\
    % + P_{A_{l}A_{r}C_lC_r}(1111)P_{C_lC_r}(00)\\
    % - P_{A_lA_rB_lB_rC_lC_r}(110011)P_{C_lC_r}(00) \\
    % - P_{A_lA_rB_lB_rC_lC_r}(110010)P_{C_lC_r}(01) \\
    % + P_{A_lA_rB_lB_rC_lC_r}(001001)P_{C_lC_r}(10) \\
    % - P_{A_lA_rB_l}(001)P_{C_lC_r}(10) \\
    % + P_{A_lA_rB_lB_rC_lC_r}(000000)P_{C_lC_r}(11) \\
    % \leq 0
    % \end{gathered}
    % \end{equation*}

    % In order to understand the importance of $I\tsb{WagonWheel}$, there are a couple of important concepts to understand. First, the Fritz distribution was originally known to be incompatible with the Triangle structure due to the perfect correlation between $C$ and the measurement pseudo-settings $A_l, B_l$. The inequality of $I\tsb{WagonWheel}$ represents a significant advancement in our understanding of non-classicality in the Triangle structure. For example, $I\tsb{WagonWheel}$ is violated by distributions that do not exhibit perfect correlation between $C$ and $A_l, B_l$. Furthermore, the existence of an inequality capable of witnessing the non-classicality of the Fritz distribution is guaranteed and the Inflation Technique is capable of producing such an inequality~\cite{Navascues_2017}, albeit requiring a sufficiently complex inflation of the Triangle structure. In fact, $I\tsb{WagonWheel}$ was derived using the Wagon-Wheel inflation depicted in \cref{fig:wagon_wheel_inflation}; smaller inflations of the Triangle structure such as the Spiral inflation (\cref{fig:spiral_inflation}) and others were \textit{not} able to produce causal compatibility inequalities that witness the Fritz distribution. This result demonstrates that the Inflation Technique is the first tool-set powerful enough to produce causal compatibility inequalities such as $I\tsb{WagonWheel}$ strong enough to witness incompatible quantum distributions for the Triangle structure. More universally, this result shows that the Inflation Technique is a promising tool for understanding quantum non-classical in more general causal structures.


    % The majority of these inequalities share most or all of the qualitative features of $I\tsb{WagonWheel}$, and hence those inequalities are omitted from this manuscript.

    \subsection{The Web Inequality}
    \label{sec:noise}
    \label{sec:violations_noise}
    We next present \cref{eq:web_inequality}, another causal compatibility inequality for the Triangle structure that is violated by the Fritz distribution. The Web inflation shown in \cref{fig:the_web_inflation} was used to produce the eponymous $I\tsb{Web}$ per \cref{eq:web_inequality}.  The Web inflation is considerably larger than the Wagon-Wheel inflation; it is computationally more demanding to work with, albeit capable of yielding strictly stronger inequalities. For brevity, we employ the shorthand $\prob\br{abc}$ in lieu of $\prob[ABC]\br{abc}$ in presenting \cref{eq:web_inequality}.

    \begin{gather}
    \label[ineq]{eq:web_inequality}
        I\tsb{Web} : \\\nonumber
        \includegraphics[clip, trim=0cm 0cm 0cm 0.5cm, width=\linewidth]{figures/inequalities/no_symwitness_ineq_print_standalone_halfed}
    \end{gather}

    % \subsection{Noisy Distributions}

    % \begin{figure}
    % \begin{nscenter}
    %         \includegraphics[scale=0.6,trim={0 0 0 0.4in},clip]{figures/distributions/uniform_dist_plot.pdf}
    %         \vspace{-0.2in}
    %         \[ \probplotvalue{255, 255, 109} = \f{1}{64} \]
    %         \caption{The completely uniform distribution $\s{U}$ visualized using a $4 \times 4 \times 4$ grid.}
    %         \label{fig:uniform_distribution}
    % \end{nscenter}
    % \end{figure}
    As mentioned in \cref{sec:fritz_distribution}, this original proof of the non-classicality of $\prob[\fritz]$ required an idealistic condition to hold: perfect correlations of $C$ with $A_l, B_l$. It is impossible to use Fritz's original argument to confirm non-classicality from an experimental point of view, because every laboratory-achievable distribution is subject to some amount of \text{noise}. One can minimize noise. e.g. by developing high-accuracy measurement channels, but \emph{perfect} correlations are unattainable. Causal compatibility inequalities such as  $I\tsb{Web}$ permit there to be noise within a set of observations before the ability to certify non-classicality breaks down.

    Here we quantify how much statistical noise can be added to the Fritz distribution $\prob[\fritz]$ before $I\tsb{Web}$ fails to witness incompatibility; we define the \term{$\vep$-noisy Fritz distribution} as
    \begin{align}
        \begin{split}
            \s{N}_{\vep} = \br{1 - \vep} \prob[\fritz] + \vep \s{U}_{ABC} \quad \text{where} \quad \s{U}_{ABC}\br{abc} \equiv \f{1}{64} \quad \forall a,b,c\in \bc{0,1,2,3}\,. \\
        \end{split}
    \end{align}
    %
    %The uniform-noise probability distribution is defined for three parties and four outcomes as $\s{U}\br{abc} = \s{U}_{ABC}\br{abc} \equiv \f{1}{64} \quad \forall a,b,c\in \bc{0,1,2,3}$\footnote{The completely noisy observation is compatible with the Triangle structure}. Here we quantify how much statistical noise can be added to the Fritz distribution $\prob[\fritz]$ before $I\tsb{Web}$ fails to witness incompatibility. The associated quantifier used was an affine noise parameter $\vep$ such that $0 \leq \vep \leq 1$ where $\s{N}_{\vep}$ denotes an \term{$\vep$-noisy Fritz distribution},
    % \[ \s{N}_{\vep} = \br{1 - \vep} \prob[\fritz] + \vep \s{U} \]

    As $\vep$ varies from $0$ to $1$, noise is added to the Fritz distribution and $\s{N}_{\vep}$ transitions from an incompatible distribution $\s{N}_{0} = \prob[\fritz]$ to a compatible distribution $\s{N}_{1} = \s{U}_{ABC}$. We find that $I\tsb{Web}$ demonstrates that the Fritz distribution remains incompatible with the Triangle structure up to a noise parameter of $\vep \simeq 0.085$; the associated distribution $\s N_{0.085}$ is plotted in \cref{fig:noisy_fritz}. Of course, there remains the possibility that another inequality will be able to withstand a larger degree of noise than $I\tsb{Web}$; an exhaustive search has not been conducted.

    % Given that $I_0, I_1, I_2, I_3$ are far from a representative inequalities and are likely not facets of any inflated marginal polytope, it is save to say that this is possible.

    % \begin{figure}
    % \begin{subfigure}[b]{.48\linewidth}
    % {\centering\includegraphics[width=\linewidth]{figures/noise/noise_2017.pdf}}
    % \caption{Complete range of noise parameters $\vep$.}\label{fig:noise}
    % \end{subfigure}
    % \begin{subfigure}[b]{.48\linewidth}
    % {\centering\includegraphics[width=\linewidth]{figures/noise/noise_2017_lims.pdf}}
    % \caption{\Cref{fig:noise} zoomed onto relevant region.}\label{fig:noise_zoomed}
    % \end{subfigure}
    % \caption{Inequality violations when subjected to uniform noise. Each inequality is normalized so that maximum violation is $-1$.}\label{fig:master_noise}
    % \end{figure}

    % The results of our experiments are plotted in \cref{fig:master_noise}. \Cref{fig:noise} illustrates that each curve $I\br{\s{N}_{\vep}\br{\prob[\fritz]}}$ as a function of $\vep$ is monotonically increasing as expected; the more noise added to the probability distribution, the more classical it becomes. \Cref{fig:noise_zoomed} is the same plot as \cref{fig:noise} zoomed onto the interval $\vep \in \bs{0, 0.12}$.

    \begin{figure}
    \begin{nscenter}
            \includegraphics[scale=0.6,trim={0 0 0 0.4in},clip]{figures/noise/noisy_yet_non_local_fritz.pdf}
            \vspace{-0.2in}
            \[ \probplotvalue{255, 255, 243} = 0.00133 \]
            \caption{$\s{N}_{0.085}$: A noisy yet still non-classical variant of the Fritz distribution.}
            \label{fig:noisy_fritz}
    \end{nscenter}
    \end{figure}

    \subsection{The Symmetric Web Inequality}
    In \cref{sec:optimizations} we will consider numerically optimizing our inequalities over quantum strategies --- seeking violations --- towards the desired end-goal of discovering new forms of non-classicality in the Triangle structure. Of course, if some inequality achieves its optimal quantum violation on a distribution qualitatively similar to $\prob[\fritz]$, then such an inequality is unlikely to lead us to discover non-classicality of a type different than $\prob[\fritz]$. Indeed, we will show that the previous pair of $I\tsb{WagonWheel}$ and $I\tsb{Web}$, which were both specifically curated to demonstrate the incompatibility of $\prob[\fritz]$, apparently achieve maximum quantum violation on distribution very similar to $\prob[\fritz]$ itself.
    To avoid the chasing our own tail in the numerical optimization we require an objective function which is \emph{not} tailor-designed to witness $\prob[\fritz]$. Finding such an inequality proved extremely challenging; while we could generate thousands of inequalities using the Inflation Technique~\cite{Inflation}, it appeared than only a vanishingly-small fraction of those inequalities admitted quantum violation whatsoever. We therefore modified the Inflation Technique to give us an inequality which both witnesses the non-classicality of $\prob[\fritz]$ but which is also symmetric with respect to any permutation of the variables $A, B, C$, resulting in \cref{eq:symmetric_web_inequality}. The modification of the Inflation Techniques which forces symmetry is explained in \cref{sec:symmetric_inequalities}. As $\prob[\fritz]$ is strongly assymetric due to the special role of $C$, we can hope that a symmetric inequality (even one which does witness $\prob[\fritz]$) might achieve its \emph{optimal} quantum violation on a distribution qualitative distinct from $\prob[\fritz]$. The details of our numerical finding are discussed in \cref{sec:optimizations}.


    % To reiterate, the Fritz distribution is incompatible with the Triangle structure because it assigns a unique role to one of the variables, specifically $C$. The asymmetry within the Fritz distribution is reflected in the asymmetry of $I\tsb{WagonWheel}$ and $I\tsb{Web}$. In order to discover new forms of non-classicality in the Triangle structure, it is desirable to obtain measures of non-classicality, such as inequalities, that do not admit this bias. In an effort to find a causal compatibility inequality qualitatively distinct from $I\tsb{WagonWheel}$ or $I\tsb{Web}$, we developed a technique to derive inequalities with certain symmetry properties such as \cref{eq:symmetric_web_inequality} which is symmetric with respect to any permutation of the variables $A, B, C$. These techniques are explained in \cref{sec:symmetric_inequalities}. Surprisingly, \cref{eq:symmetric_web_inequality} is also violated by the Fritz distribution.

    \begin{gather}
        \label[ineq]{eq:symmetric_web_inequality}
        I\tsb{SymmetricWeb} : \\\nonumber
        \includegraphics[clip, trim=0cm 0cm 0cm 0.5cm, width=\linewidth]{figures/inequalities/MosekCertFritzSym_ineq_standalone_halfed}
    \end{gather}

    Note that $\prob\br{abc}$ is shorthand for $\prob[ABC]\br{abc}$ and $\bs{P(113)P(330)}_3$ is shorthand for a sum the over permutations of $A,B,C$, i.e. $\bs{P(113)P(330)}_3 \defined P(113)P(330) + P(131)P(303) + P(311)P(033)$.


    \section{Numerical Optimization}\label{sec:optimizations}

    % Causal compatibility inequalities, including those derived in \cref{sec:found_inequalities}, offer an avenue into studying quantum non-classicality. Ultimately, the motivation for finding these inequalities is binary: the first is to classify differing distributions by their compatibility with a given causal structure, and the second is to measure the degree in which a given distribution is non-classical. This approach has been well-studied in the Bell structure, where extremal non-classical correlations maximally violate Bell inequalities~\cite{PR_1995}. However, inequalities are just a singular example of numerous distinct measures of non-classicality~\cite[Section 5]{Vicente_2014}. Alternatives include measuring the non-local content, robustness to noise, or even the classical simulation cost of a given distribution. For previously studied causal structures, such as the Bell structure, there exists a uncertainty toward which measure of non-classicality is best. The inequalities derived in this report are likely \textit{not} the best measures of non-classicality because they have be curated toward the Fritz distribution. Nonetheless, these inequalities act the \textit{first} measures of non-classicality in the Triangle structure to be found that admit quantum violations. In this section, two measures are used that make use of these compatibility inequalities: robustness to noise and direct numerical violation.

    % To compare different inequalities simultaneously, our convention is to rearrange each inequality $I$ into the format of \cref{eq:ww_ineq,eq:web_inequality,eq:symmetric_web_inequality} where the linear combination of all terms is upper-bound by $0$. For each inequality $I$ and distribution $\prob$, $I\br{\prob}$ denotes the numerical value associated with this upper-bound. Correspondingly, $I\br{\prob} > 0$ indicates violation of $I$ while $I\br{\prob} \leq 0$ indicates satisfaction of $I$ (with $I\br{\prob} = 0$ corresponding to complete saturation of the inequality).



    %\subsection{Numerical Optimizations}


    In order to find quantum distributions that are more non-classical than the Fritz, we performed numerical optimizations against each inequality $I$ by parameterizing the space of quantum-accessible probability distributions that can be realized on the Triangle structure (\cref{fig:triangle_structure}) and thus expressed in the form of \cref{eq:triangle_Qcompatibility}. In order to parameterize all such distributions, we elect to parameterize the states and measurements separately. In order to qualify the scope of \cref{eq:triangle_Qcompatibility} and associated computational complexity of the parameterization, there are a two restrictions that are made with justification. Motivated by the fact that the Fritz distribution (\cref{sec:fritz_distribution}) only requires qubit states, the states $\rho$ are taken to be bipartite \textit{qubit} states which are more computationally feasible compared to $n$-dimensional states whereby the joint density matrix $\rho_{AB}\otimes\rho_{BC}\otimes\rho_{CA}$ becomes an $n^6 \times n^6$ matrix. Additionally, we restrict our focus to projective-valued measures (PVMs) instead of projective-operator valued measures (POVMs) for three reasons. First,~\citet{Fritz_2012} demonstrates via the Fritz distribution that PVMs are sufficient for generating incompatible quantum distributions in the Triangle structure. Second, although generating $k$-outcome POVM measurements is possible using rejection sampling techniques~\cite{Petz_2015}, a valid, unbiased parameterization was not found for $k > 2$. Finally, PVMs provide considerable computational advantage over POVMs as they permit \cref{eq:triangle_Qcompatibility} to be re-written as \cref{eq:quantum_model_triangle_pvms}.
    \[ \prob[ABC]\br{abc} = \bramidket{m_{A,a}m_{B,b}m_{C,c}}{\netperm^\intercal \rho_{AB}\otimes\rho_{BC}\otimes\rho_{CA} \netperm}{m_{A,a}m_{B,b}m_{C,c}} \eq \label{eq:quantum_model_triangle_pvms}\]

    Although there are numerous techniques that can used when parameterizing quantum states and measurements~\cite{Petz_2015, Hedemann_2013,Fujii_2005,James_2001,Grasmair_2014,Neilsen_Chaung_2011}, a single technique by \citet{Spengler_2010_Unitary} was found to be most computationally suitable for our purposes. \Citet{Spengler_2010_Unitary} demonstrated that all $d\times d$ unitary matrices $U$ can be parameterized without degeneracy as follows:
    \[ U = \bs{\prod_{m=1}^{d-1} \br{\prod_{n=m+1}^{d} \exp\br{i P_n \lambda_{n,m}}\exp\br{i \si_{m,n} \lambda_{m,n}}}} \cdot \bs{\prod_{l=1}^{d} \exp\br{iP_l \lambda_{l,l}}}  \eq \label{eq:spengler_unitary} \]
    Where the real valued parameters $\la = \bc{\la_{n,m} \mid n,m \in 1, \ldots, d}$ have periodicities $\la_{m,n} \in \bs{0, \f{\pi}{2}}$ for $m < n$ and $\la_{m,n} \in \bs{0, 2 \pi}$ for $m \geq n$. Moreover, $P_l$ are one-dimensional projective operators $P_l = \ket{l}\bra{l}$ and the $\si_{m,n}$ are generalized anti-symmetric $\si$-matrices $\sigma_{m,n} = -i \ket{m}\bra{n} +i \ket{n}\bra{m}$ where $1 \leq m < n \leq d$. This parameterization has the useful feature that each of the real-valued parameters $\la_{n,m}$ a direct and intuitive physical affect on each element of a computational basis $\bc{\ket{1}, \ldots, \ket{d}}$. Explicitly, $\exp\br{i \si_{m,n} \lambda_{m,n}}$ applies a rotation to the sub-space spanned by $\ket{m}$ and $\ket{n}$ for $m < n$. Analogously, $\exp\br{i P_n \lambda_{n,m}}$ generates the relative phase between $\ket{m}$ and $\ket{n}$ for $m > n$ and $\exp\br{iP_l \lambda_{l,l}}$ fixes the global phase of $\ket{l}$. Finally, although not explicitly mentioned in~\cite{Spengler_2010_Unitary}, it is possible to remove the reliance on the computationally expensive matrix exponential operations~\cite{Moler_2003} in \cref{eq:spengler_unitary} and replace them with elementary trigonomentric functions in the paramaters $\la_{m,n}$.

    By parameterizing unitary matrices, it becomes possible to parameterize $d$-dimensional density matrices and $d$-element PVMs by recognizing that any orthonormal basis $\bc{\ket{\psi_j}}$ (where $1 \leq j \leq d$) can be transformed into the computational basis $\bc{\ket{j}}$ by a unitary transformation $U$, i.e. $U \ket{\psi_j} = \ket{j}$. First consider a $d$-element PVM $M = \bc{\ket{m_j}\bra{m_j} \mid 1 \leq j \leq d}$. Since $\bc{\ket{m_j}}$ forms an orthonormal basis, one can parameterize $M$ by writing $M = \bc{U^{\dagger}\ket{j}\bra{j}U \mid 1 \leq j \leq d}$ and parameterizing $U$ using \cref{eq:spengler_unitary}. This method was inspired by the measurement seeding method for iterative optimization used by \citet{Pal_2010}. Analogously, this argument can be extended to full-rank $d$-dimensional density matrices $\rho$ by performing a spectral decomposition $\rho = \sum_{j=1}^{d} p_j \ket{p_j} \bra{p_j}$ into eigenvalues $\bc{p_j}$ and eigenstates $\bc{\ket{p_j}}$. Since $\Tr\br{\rho} = \sum_{j = 1}^{d} p_j = 1$ the eigenvalues of $\rho$ are parameterized without degeneracy using a tuple of $d-1$ real-valued parameters with periodicity $\bs{0, 2 \pi}$ using hyper-spherical coordinates~\cite{Hedemann_2013, Spengler_2010_Unitary}. Additionally, since $\rho$ is Hermitian, the eigenstates $\bc{\ket{p_j}}$ form an orthonormal basis and therefore the eigenstates are analogously parameterized using \cref{eq:spengler_unitary}: $\rho = \sum_{j=1}^{d} p_j U^{\dagger} \ket{j} \bra{j} U$. For our purposes, we have set $d = 4$ and fixed $\la_{l, l} = 0$ for $1 \leq l \leq d$ in \cref{eq:spengler_unitary} because the global phase contributions are irrelevant for \cref{eq:quantum_model_triangle_pvms}.

    % \Cref{sec:param_quantum_dist} expounds on our parameterized of the space of quantum distributions that can be realized on the quantum Triangle structure (\cref{fig:triangle_structure_quantum_model}) pursuant to \cref{eq:quantum_model_triangle_pvms}. Specifically, each bipartite quantum resource is modeled $2$-qubit, $4\times 4$ density matrix and each measurement is modeled as a $4$-element projective-value measure.

    % the a objective scalar function $f: \R^n \in \R$ using the following pipeline: To begin, a set of real-valued parameters $\la = \br{\la_0, \ldots, \la_n} \in \R^{n}$ are used to parameterize a set of quantum states $\rho_{AB}, \rho_{BC}, \rho_{CA}$ and measurements $M_A, M_B, M_C$ in agreement with the quantum version of the Triangle structure in \cref{fig:triangle_structure_quantum_model}. Second, a $4$-outcome distribution $\prob[ABC]$ is obtained via \cref{eq:triangle_Qcompatibility} and supplanted into an inequality $I$ in homogeneous and canonical form $I\br{\prob[ABC]} \leq 0$. The objective value is simply the degree of violation $f = I\br{\prob[ABC]}$ and used to make adjustments to $\la$ in order to achieve largest and larger violations.

    % \subsection{Parameterizing Quantum Distributions}
    % \begin{figure}
    % \begin{nscenter}
    %         \scalebox{1.0}{\input{figures/causal_structures/triangle_structure_operational}}
    %         \caption{The Triangle structure as modeled by quantum states and measurements.}
    %         \label{fig:triangle_structure_quantum_model}
    % \end{nscenter}
    % \end{figure}
    % An alternative explanation for qualitative similarities between \cref{fig:maximum_violation_I_1} and \cref{fig:fritz_distribution_visualized} is related to the sensitively of the initial parameters to our optimization. Above, it was shown that our parameter space of choice was $2\pi$-periodic in all entries. Somewhat surprisingly, when supplied with randomly sampled initial parameters, all optimization methods consistently converged to saturating $I\tsb{Web}$ instead of violating it. We observed that only parameters close enough to the \textit{Fritz parameters} (i.e. parameters that induce the Fritz distribution) were able to achieve violation of $I\tsb{Web}$.

    Since the inequalities we seek to optimily violate are polynomial, and since the space of quantum-accessible distributions is non-convex, we employ a number of optimization methods consecutivey in an attempt to avoid pitfalls associated with local minima or ill-conditioned convergence. Specifically, the BFGS method~\cite[p.142]{Nocedal_2000} and the Nelder-Mead simplex method~\cite[p.238]{Nocedal_2000} were used along with a method called Basin Hopping~\cite{Wales_1997}, which is a hybrid between simulated annealing and gradient descent-based methods.

    Nevertheless, we strongly caution against misinterpreting the numerical optima present in \cref{sec:optima} as if our findings represent genuine global-maxima of violation. Evidence for the unreliability of our numerical methods is the following: when supplied with randomly sampled initial parameters, \emph{all} optimization methods consistently converged to \emph{saturating} the target inequalities, instead of violating it! This, even though we \emph{know} that all the inequalities we consider \emph{do} admit quantum violation, namely by  $\prob[\fritz]$. To achieve inequality violation, we found ourselves forced to seed the numerical method with initial  parameters such that the initial point of the optimization was close to  $\prob[\fritz]$.

    The fact that the \emph{final} points of optimization as returned by our numerical methods are invariably also close to $\prob[\fritz]$ makes interpreting the results somewhat murky. Could it be that the inequality's global maximum is, in-fact, not far from $\prob[\fritz]$? Or is this a limitation of the ill-conditioned nature of the optimization? The phenomena is likely due to a combination of both effects.

    % Despite our varied efforts, it remains unclear whether or not our results share the same possibilistic structure as $\prob[\fritz]$ because of the inequality itself or the ill-conditioned nature of the optimization. More likely, this phenomena is due to a combination of both effects.

    \subsection{Numerical Optimization Results}\label{sec:optima}

    \begin{figure}
    \begin{nscenter}
        \includegraphics[scale=0.6,trim={0 0 0 0.4in},clip]{figures/distributions/plotted_dist_I_1_max_violation_2017.pdf}
        \caption{A quantum probability distribution of the Triangle structure that maximizes violation of $I\tsb{Web}$. Notice that this distribution has precisely the same possibilistic structure as the Fritz distribution, as might be expected, since $I\tsb{Web}$ was specifically generated to witness the non-classicality of $\prob[\fritz]$.}
        \label{fig:maximum_violation_I_1}
    \end{nscenter}
    \end{figure}
    \begin{figure}
    \begin{nscenter}
        \includegraphics[scale=0.6,trim={0 0 0 0.4in},clip]{figures/distributions/plotted_dist_I_3_max_violation_2017.pdf}
        \caption{A quantum probability distribution of the Triangle structure that maximizes violation of $I\tsb{SymmetricWeb}$. Notice that this distribution has precisely the same (assymetric!) possibilistic structure as the Fritz distribution, even though $I\tsb{SymmetricWeb}$ itself is symmetric with respect to permutations of the variables $A, B, C$. }
        \label{fig:maximum_violation_I_3}
    \end{nscenter}
    \end{figure}
    % \begin{figure}
    % \begin{nscenter}
    %         \includegraphics[scale=0.6,trim={0 0 0 0.4in},clip]{figures/distributions/symmetrized_fritz.pdf}
    %         \caption{An artificially-symmetrized version of the Fritz distribution, constructed by averaging the six permutations of $\prob[\fritz]$ over the variables $A, B, C$. While this construction significantly violates $I\tsb{SymmetricWeb}$, we have no reason to believe that this distribution should actually be achievable using quantum resources in the Triangle structure, so its role here is purely apophatic.}
    %         \label{fig:symmetrized_fritz}
    % \end{nscenter}
    % \end{figure}

    %To quantify the degree in which each inequality $I$ could be further violated, we define a relative violation $V_F$ to be the maximum violation relative to the violation achieved by the Fritz distribution, i.e. $V_F \defined \max_{P}\bc{I\br{P}/I\br{P_F}}$.
    Our best numerical optimization of $I\tsb{WagonWheel}$ was found to be the Fritz distribution itself, visualized in \cref{fig:fritz_distribution_visualized}. $\prob[\fritz]$ is therefore either a local minimum of the parameter space or is in fact \textit{the} maximally violating distribution of $I\tsb{WagonWheel}$; it remains unclear to us if this behavior is related to the global optimality of the Fritz distribution, or if it's an artifact of the methods used to derive $I\tsb{WagonWheel}$, though we suspect the former.

    Our best numerical optimization of $I\tsb{Web}$ is visualized in\cref{fig:maximum_violation_I_1}. Almost immediately, it is evident that \cref{fig:maximum_violation_I_1} closely resembles the Fritz distribution; in fact \cref{fig:maximum_violation_I_1} and \cref{fig:fritz_distribution_visualized} share their \term{possibilistic structure}. A distribution's possibilistic structure is the unitization of its probabilities, i.e. the partitioning of events into disjoint subsets: one containing those events that occur with nonzero probability (possible), the other containing the zero-probability events (impossible).
    That \cref{fig:maximum_violation_I_1} and \cref{fig:fritz_distribution_visualized} have the same possibilistic structure is not entirely unexpected;  As was mentioned in \cref{sec:found_inequalities}, as $I\tsb{Web}$ was derived specifically to prove the incompatibility of the Fritz distribution with the Triangle structure. Consequently, it seems that $I\tsb{Web}$ best witnesses incompatibility of those distributions that closely resemble the $\prob[\fritz]$. It could be, however, that the sharing of possibilistic structure is an artifact of unreliable convergence, such that the true optimally-violating $I\tsb{Web}$ quantum distribution might have a different structure.

    It is perhaps curious, however, that the distribution in \cref{fig:maximum_violation_I_1} is not accessible when the bipartite states in \cref{eq:triangle_Qcompatibility} are restricted to maximally entangled states. This distributions certainly violate $I\tsb{Web}$ more than $\prob[\fritz]$, even it is isn't the global maximum of $I\tsb{Web}$. This finding of more-violation with less-entanglement resembles a feature of quantum mechanics originally presented by~\citet{Methot_2006} demonstrating that entanglement and non-classicality are different resources.

    % The Gaussian perturbation was given zero mean $\mu = 0$ and variance $\si^2 = \br{2 \pi 10^{\chi}}^2$ where $\chi$ measures an order of magnitude standard deviation. For $I_1$, deviations of $\chi \gtrsim 1.3$ inhibited convergence to violation. This is depicted in \cref{fig:initial_conditions}.

    % \begin{figure}
    % \begin{subfigure}[t]{.48\linewidth}
    % {\centering\includegraphics[width=\linewidth]{figures/optimizations/Gaussian_Perturbation_Fritz_Color_Default.pdf}}
    % \caption{For each iteration step $k$, the inequality target decreases.}\label{fig:initial_conditions_a}
    % \end{subfigure}
    % \begin{subfigure}[t]{.48\linewidth}
    % {\centering\includegraphics[width=\linewidth]{figures/optimizations/Gaussian_Perturbation_Fritz_Color_Zoomed.pdf}}
    % \caption{\Cref{fig:noise} zoomed to show convergence is sensitive to initial conditions.}\label{fig:initial_conditions_b}
    % \end{subfigure}
    % \caption{Numerical optimizations aimed at violating causal compatibility inequalities are sensitive to initial conditions.}\label{fig:initial_conditions}
    % \end{figure}

    Our best numerical optimization of $I\tsb{SymmetricWeb}$ is visualized in \cref{fig:maximum_violation_I_3}. Counter-intuitively, this distribution --- which violates $I\tsb{SymmetricWeb}$ considerably better than $\prob[\fritz]$ --- \emph{still} shares its possibilistic structure with the Fritz distribution! Since $I\tsb{SymmetricWeb}$ is symmetric with respect to the permutation of parties, one might expect that the maximum violating distribution be symmetric as well. Our numerical optimization, however, failed to find \emph{any} symmetric quantum distributions capable of violating $I\tsb{SymmetricWeb}$, not even violating it suboptimally than $\prob[\fritz]$. The \emph{only} violations of $I\tsb{SymmetricWeb}$ appear to be by assymetric distributions.

    % If it were not, one could construct a distribution that violates $I\tsb{SymmetricWeb}$ further by symmetrizing $\prob[\fritz]$ (\cref{fig:symmetrized_fritz}) by normalizing over all possible permutations of $A,B,C$. This distribution is also non-classical with relative violation $V_F = 3$. As it turns out, numerical optimizations suggest that the symmetrized Fritz distribution is \textit{not} quantum-accessible in the sense that is cannot be written as \cref{eq:triangle_Qcompatibility}. Therefore we conclude that the space of quantum-accessible correlations on the Triangle structure is non-convex; a reiteration of a result mentioned in~\citet{Inflation}.


    \section{Conclusions}
    \label{sec:conclusions}
    In \cref{sec:triangle_structure}, we elucidated that establishing or rejecting compatibility with the Triangle structure has been a challenging problem for nearly a decade \cite{Steudel_2010,Branciard_2012,Henson_2014,Fritz_2012,Gisin_2017}. Though some causal compatibility inequalities were known, those inequalities did not appear useful for the purpose of witnessing quantum non-classicality. Recently,~\citet{Fritz_2012} gave the the first example of quantum non-classicality in the Triangle structure, relying on an inequality-free proof that is not robust to any amount of noise.

    % Initially,~\citet{Branciard_2012} identified the Triangle structure as a challenging causal structure for studying non-classicality. Afterwards,~\citet{Henson_2014} were able to to classify the Triangle structure as \textit{interesting} which partially explains why it remains an enigma. Recently,~\citet{Fritz_2012} discovered the Fritz distribution as the first example of quantum non-classicality in the Triangle structure. In \cref{sec:fritz_distribution} the Fritz distribution was described in detail along with Fritz's Problem~\cite[Problem 2.17]{Fritz_2012}. Heretofore, researchers have been able to derive causal incompatibility inequalities~\cite{Inflation,Steudel_2010,Henson_2014} but unable to show that any are non-trivial in the context of quantum non-classicality.

    % Using the Inflation technique, it became possible to provide a stronger proof of non-classicality than proposed by Fritz~\cite{Fritz_2012}. In particular, noisy variants of the Fritz distribution are provably non-classical (\cref{sec:noise}) and
    In \cref{sec:found_inequalities} we presented the first examples of causal compatibility inequalities capable of having quantum violations in the sense that they are violated by quantum-accessible distributions. This result was made possible through the Inflation Technique \cref{sec:inflation_technique_summary} applied to the Fritz distribution.

    In \cref{sec:noise} we demonstrated that a causal compatibility inequalities is robust to noise, directly revealing a critical departure from Fritz's original proof of the incompatibility of the Fritz's perfect-correlation example. In \cref{sec:optimizations} we found quantum distributions quantitatively distinct from the Fritz's recycled-Bell's-theorem example, such that these variant distribution more strongly violate certain causal compatibility inequalities.

    % In the context of Fritz's Problem, our result corresponds to a resolution to the following \textit{reinterpretation} of Fritz's original Problem:
    % \begin{enumerate}[label=\textbf{FP.\Alph*}]
    %     \setcounter{enumi}{0}
    %     \item \label{r:1} Find proofs for causal incompatibility of quantum distributions on the Triangle structure that are \textit{not} reliant on perfect correlations.
    % \end{enumerate}
    % Ultimately, this work accomplishes two important tasks. First and foremost, the derivation of inequalities such as \cref{eq:ww_ineq} demonstrates the utility of the Inflation Technique specifically for quantum causal inference problems. The Inflation Technique was able to derive causal compatibility inequalities that admit quantum violations in the Triangle structure --- a task that no other existing techniques have succeeded at. In this sense, the results of \cref{sec:found_inequalities} showcase how the Inflation Technique is capable of generating new proofs of causal incompatibility specifically of quantum distributions for the Triangle structure. Consequently, this work strongly indicates that the Inflation Technique has the potential to solve an assortment of unsolved causal inference problems including those manifest in quantum foundations and quantum information theory. Secondly,

    %    In spirit, however,Fritz's Problem is fundamentally concerned with identifying incompatible quantum distributions in the Triangle structure that are qualitatively different than the non-classical distributions of the Bell structure discussed in \cref{sec:bell_structure}. When specifically concerned with entanglement resources, Bell structure non-classicality exploits the entanglement of a single bipartite quantum state. In the Triangle structure, the observable nodes $A,B,C$ have access to potentially three different bipartite quantum states. As noted in \cref{sec:fritz_distribution}, the Fritz distribution can be implemented using only a single entangled state.\footnote{Of course there exists implementations that make use of three entangled states but at minimum only one is necessary.} In consideration of our resolution to \ref{r:1}, we propose an alternative reinterpretation of Fritz's Problem that are concerned more with the nature of the entanglement resource being exploited in a incompatible quantum distribution:

    % \begin{enumerate}[label=\textbf{FP.\Alph*}]
    %     \setcounter{enumi}{1}
    %     \item \label{r:2} Find incompatible quantum distributions on the Triangle structure that require entanglement in more than one shared state.
    % \end{enumerate}

    % The question, as proposed by \ref{r:2}, is: does there exist incompatible quantum distributions that genuinely require the entanglement resources of three states? At first, one might suspect that finding such distributions would affirmatively demonstrate a new form of entanglement resource distinct to the Triangle structure. Unfortunately, this is not the case. By increasing the cardinality of the outcomes for $A, B, C$, it is possible to generate a distribution that is non-classical yet quantum and requires all three of the shared resources to be entangled. This can be accomplished by superimposing three copies of statistically independent Fritz distributions to the Triangle structure, each of which utilizes a distinct party to announce the corresponding measurement pseudo-settings. Such a distribution would be of the form described by \ref{r:2} because under this construction, the removal of any entangled resource would render the distribution quantum-inaccessible. Consequently, it becomes desirable to find non-classical quantum correlations for the Triangle structure which have the fewest number of outcomes. In pursuit of this objective, the authors were able to prove the non-classicality (using the methods described in \cref{sec:inflation_technique_summary}) of a variant of the Fritz distribution where $C$ has only two outcomes: the first corresponding to $A, B$ correlations and the second corresponding to $A, B$ anti-correlations. These advancements suggest the cardinality of measurement outcomes are intimately connected to quantum non-classicality and is a recommended focus for future research.

    Despite these advancements, the distributions we discovered hew closely to the Fritz distribution, indicating that their non-classical nature remains some recycled version of the non-classicality found in the Bell structure. Currently, it remains speculative about how to recognize whether-or-not a given distribution for the Triangle structure exhibits non-classical correlations of a fundamentally novel qualitative nature than Bell-type non-classicality. We imagine that advantages from a resource perspective might be critical to establish such a novelty signature.
    Perhaps another signature would be if the distribution can arise in the Triangle structure only through the use of of entangled measurements, such as perhaps the conjecture in Ref. \cite{Gisin_2017}. Ultimately, given any said classifier, it remains unclear whether or not such distributions even exist.

    \begin{acknowledgments}
    This research was supported in part by Perimeter Institute for Theoretical Physics. Research at Perimeter Institute is supported by the Government of Canada through the Department of Innovation, Science and Economic Development Canada and by the Province of Ontario through the Ministry of Research, Innovation and Science. The authors are grateful to Miguel Navascués and Denis Rosset for their insightful dicussions.
    \end{acknowledgments}

    \appendix

    \section{Marginal Satisfiability and Inequalities}
    \label{sec:marginal_satisfiability}

    This section aims to explain how to solve the following decision problem: given a collection of probability distributions $\bc{\prob[V_1], \ldots, \prob[V_m]}$ where each set of variables $V_{i} \subseteq \jointvar$ is a subset of some complete set of variables $\jointvar$, does there exist a joint distribution $\prob[\jointvar]$ such that each $\prob[V_i]$ can be obtained by marginalizing $\prob[\jointvar]$ over the variables not in $V_i$, i.e. $\prob[V_i] = \sum_{\jointvar \setminus V_i} \prob[\jointvar]$? Colloquially, this problem is referred to as \term{the marginal problem}~\cite{Fritz_2011}. Additionally, this section aims to accomplish something further: If such as joint distribution $\prob[\jointvar]$ exists, how does one find it? If not, how does one find an inequality whose violation by $\bc{\prob[V_1], \ldots, \prob[V_m]}$ proves the non-existence of a joint distribution. This is accomplished by illustrating how the marginal problem can be expressed as a linear program in which the solution to the marginal problem is encoded in the feasibility or infeasibility of said linear program. This section is presented prior to \cref{sec:inflation_technique_summary} as the marginal problem becomes an integral component of the Inflation Technique in subsequently deriving the inequalities presented in \cref{sec:found_inequalities}. Moreover, the Marginal problem is presented here logically independent from the remainder of the manuscript both for procedural clarity and because the marginal problem has applications to numerous areas of mathematics including game theory~\cite{Vorobev_1962}, database theory, knowledge integration of expert system, and of course, quantum information theory~\cite{Fritz_2011}.

    To begin, several pieces of nomenclature will be introduced to facilitate discussions. First, the set $\mscenario = \bc{V \mid V \subseteq \jointvar}$ of subsets of $\jointvar$ is referred to as the \term{marginal scenario} and each element $V \in \mscenario$ is termed a \term{(marginal) context} of $\mscenario$. The complete set of marginal distributions is referred to as the \term{marginal model} and is denoted with an superscript $\prob^{\mscenario} \defined \bc{\prob[V] \mid V \in \mscenario}$. A marginal model acts as the most general description of a family of observations that can be made over $\jointvar$. Strictly speaking, as defined by~\cite{Fritz_2011}, a marginal scenario forms an \textit{abstract simplicial complex} where it is required that all subsets of contexts are also contexts: $\forall V \in \mscenario, V' \subset V : V' \in \mscenario$. Throughout this section, we exclusively consider (without loss of generality) the \textit{maximal} marginal scenario; restricting our focus to the largest marginal contexts. Additionally, all marginal scenarios are taken to be \text{complete} in the sense that the marginal scenario covers the complete set of observable variables, i.e $\jointvar = \bigcup_{V \in \mscenario} V$. Finally, we henceforth assume that each variable $v \in \s J$ has a finite cardinality.

    The marginal problem asks: given a marginal model $\prob^{\mscenario} = \bc{\prob[V] \mid V \in \mscenario}$ marginal to the joint variables $\jointvar$, does there exist a joint distribution $\prob[\jointvar]$ such that each context $\prob[V]$ can be obtained by marginalizing $\prob[\jointvar]$?
    \[ \forall V \in \mscenario : \prob[V] = \sum_{\jointvar \setminus V} \prob[\jointvar] \eq \label{eq:def:marginal_problem}\]
    A marginal model $\prob^{\mscenario}$ is said to be \textit{contextual} if it \textit{does not} admit a joint distribution and \textit{non-contextual} otherwise. Notice that \cref{eq:def:marginal_problem} is inherently a linear system of constraints which be solved rather efficiently using linear programs. In consideration of this, we will now endeavor to discuss how to cast the \cref{eq:def:marginal_problem} as a matrix multiplication equation so that it becomes possible to discuss existing methods for deriving constraints on the set of contextual marginal models.

    To every discrete random variable $v$ there corresponds a prescribed set of \term{outcomes} $O_v$. We also define the set of all \term{events over $v$}, denoted $\Events{v}$,\footnote{In the language of sheaf-theory, $\Events{v}$ is the \textit{sheaf of events}~\cite{Abramsky_2011}.} to be the set of all functions $s : \bc{v} \to O_v$ each representing the event that a measurement on $v$ was made where $s\br{v} \in O_v$ was observed. Evidently, $\Events{v}$ and $O_v$ have a one-to-one correspondence and this distinction can be confounding. There is rarely any harm in referring synonymously to either as outcomes. Nonetheless, a sheaf-theoretic treatment of contextuality~\cite{Abramsky_2011} demands the distinction.
    Specifically for this work, the distinction becomes essential for our discussion and exploit of marginal symmetries in \cref{sec:symmetric_inequalities}. As a natural generalization we define the events over a set of random variables $V = \bc{v_1, \ldots, v_n}$ in a parallel manner,
    \[ \Events{V} \defined \bc{s: V \to O_{V} \mid \forall i : s\br{v_i} \in O_{v_i} } \eq \label{eq:outcome_space}\]
    Each event $s$ can be compactly represented as a set of mappings over each element of $V$, i.e. $s = \bc{v_i\mapsto s\br{v_i}}_{i = 1}^{k}$. The domain $\Dom{s}$ of an event $s$ is the set of random variables it valuates, i.e. if $s \in \Events{V}$, then $\Dom{s} = V$. Under this framework, a probability distribution $\prob[V]$ can be considered as a map from $\Events{V}$ to the unit interval $\bs{0,1}$.
    The marginal problem inherently depends on the concept of probabilistic marginalization. This concept can be understood at the level of events; one event $s \in \Events{V}$ can be ``marginalized'' or restricted to a smaller event $s' \in \Events{W}$ whenever $W \subseteq V$. For every $W \subseteq V$ and $s \in \Events{V}$, the \term{restriction of $s$ onto $W$} (denoted $s|_{W} \in \Events{W}$) is the event in $\Events{W}$ that \textit{agrees} with each of $s$'s assignments for variables in $W$: $\forall v \in W : s|_{W}\br{v} = s\br{v}$.

    For every marginal scenario $\mscenario = \bc{V_1, \ldots, V_k}$, it is useful to put special emphasis on the \term{joint events} $\Events{\jointvar}$ which represent all possible global events over the entire set of joint variables. Similarly, we define the \term{context events} for a particular context $V \in \mscenario$ as $\Events{V}$. Finally, we elect to define the \term{marginal events} as the disjoint union over all context events and by an abuse of notation we will denote this union as $\Events{\mscenario} = \coprod_{V \in \mscenario} \Events{V}$. Each marginal section $m \in \Events{\mscenario}$ has a domain $\Dom{m} = V$ for some $V \in \mscenario$. By construction each marginal event $m \in \Events{\mscenario}$ is a restriction of some joint event $j \in \Events{\jointvar}$.
    % \subsection{Linear Programs}

    The marginalization operation of the marginal problem is a \textit{linear} operation, mapping a joint probability distribution $\prob[\jointvar] : \Events{\jointvar} \to \bs{0,1}$ into a marginal model $\prob^{\mscenario} = \bc{\prob[V] : \Events{V} \to \bs{0,1} \mid V \in \mscenario}$. Since $\Events{\mscenario}$ and $\Events{\jointvar}$ are finite, the marginal problem can be represented as a $\abs{\Events{\mscenario}} \times \abs{\Events{\jointvar}}$ matrix.

    \begin{definition}
        \label{def:incidence_matrix}
        The \term{incidence matrix} $M$ for a marginal scenario $\mscenario = \bc{V_1, \dots, V_k}$ is a bit-wise matrix where the columns are indexed by \textit{joint} events $j \in \Events{\jointvar}$ and the rows are events by \textit{marginal} events $m \in \Events{\mscenario}$. The entries of $M$ are populated whenever a marginal event $m$ is a restriction of the joint event $j$.
        \[ M_{m,j} \defined \begin{cases}
            1 & m = j|_{\s{D}\br{m}} \\
            0 & \text{otherwise}
        \end{cases} \]
        The incidence matrix has $\abs{\Events{\jointvar}}$ columns, $\abs{\Events{\mscenario}} = \sum_{i} \abs{\Events{V_i}}$ rows and $k\abs{\Events{\jointvar}}$ non-zero entries.
    \end{definition}
    To illustrate this concretely, consider the following example. Let $\jointvar$ be $3$ binary variables $\jointvar = \bc{A,B,C}$ and $\mscenario$ be the marginal scenario $\mscenario = \bc{\bc{A,B}, \bc{B,C}, \bc{A,C}}$. The incidence matrix for $\mscenario$ is:
    \[ M = \kbordermatrix{
        (A,B,C) \:\: \mapsto & (0,0,0) & (0,0,1) & (0,1,0) & (0,1,1) & (1,0,0) & (1,0,1) & (1,1,0) & (1,1,1) \\
        (A\mapsto0, B\mapsto0) & \kone & \kone & \kzer & \kzer & \kzer & \kzer & \kzer & \kzer \\
        (A\mapsto0, B\mapsto1) & \kzer & \kzer & \kone & \kone & \kzer & \kzer & \kzer & \kzer \\
        (A\mapsto1, B\mapsto0) & \kzer & \kzer & \kzer & \kzer & \kone & \kone & \kzer & \kzer \\
        (A\mapsto1, B\mapsto1) & \kzer & \kzer & \kzer & \kzer & \kzer & \kzer & \kone & \kone \\
        (B\mapsto0, C\mapsto0) & \kone & \kzer & \kzer & \kzer & \kone & \kzer & \kzer & \kzer \\
        (B\mapsto0, C\mapsto1) & \kzer & \kone & \kzer & \kzer & \kzer & \kone & \kzer & \kzer \\
        (B\mapsto1, C\mapsto0) & \kzer & \kzer & \kone & \kzer & \kzer & \kzer & \kone & \kzer \\
        (B\mapsto1, C\mapsto1) & \kzer & \kzer & \kzer & \kone & \kzer & \kzer & \kzer & \kone \\
        (A\mapsto0, C\mapsto0) & \kone & \kzer & \kone & \kzer & \kzer & \kzer & \kzer & \kzer \\
        (A\mapsto0, C\mapsto1) & \kzer & \kone & \kzer & \kone & \kzer & \kzer & \kzer & \kzer \\
        (A\mapsto1, C\mapsto0) & \kzer & \kzer & \kzer & \kzer & \kone & \kzer & \kone & \kzer \\
        (A\mapsto1, C\mapsto1) & \kzer & \kzer & \kzer & \kzer & \kzer & \kone & \kzer & \kone
    } \eq \label{eq:example_incidence}\]
    The incidence matrix acts (to the right) on a vector representing the joint probability $\prob[\jointvar]$ distribution and outputs a vector representing the marginal model $\prob^{\mscenario}$. The \term{joint distribution vector} $\probvec^{\jointvar}$ for a probability distribution $\prob[\jointvar]$ is the vector indexed by joint events $j \in \Events{\jointvar}$ whose entries are populated by the probabilities that $\prob[\jointvar]$ assigns to each joint event: $\probvec^{\jointvar}_j = \prob[\jointvar][j]$. Analogously, \term{marginal distribution vector} $\probvec^{\mscenario}$ for a marginal model $\prob^{\mscenario}$ is the vector whose entries are probabilities over the set of marginal outcomes $\Events{\mscenario}$: $\probvec^{\mscenario}_m = \prob[\Dom{m}][m]$.

    By design, the marginal and joint distribution vectors are related via the incidence matrix $M$. Given a joint distribution vector $\probvec^{\jointvar}$ one can obtain the marginal distribution vector $\probvec^{\mscenario}$ by multiplying $M$ by $\probvec^{\jointvar}$.
    \[ \probvec^{\mscenario} = M \cdot \probvec^{\jointvar} \eq \label{eq:incidence_matrix_use} \]
    As a quick remark, the particular ordering of the rows and columns of $M$ carries \textit{no importance}, but it \textit{must} be consistent between $M$, $\probvec^{\jointvar}$ and $\probvec^{\mscenario}$. The marginal problem can now be rephrased in the language of the incidence matrix. Suppose one obtains a marginal distribution vector $\probvec^{\mscenario}$; the marginal problem becomes equivalent to the question: does there exist a joint distribution vector $\probvec^{\jointvar}$ such that \cref{eq:incidence_matrix_use} holds? This question is naturally framed as the \term{marginal linear program}:
    \begin{equation}
    \begin{aligned}
        & \text{minimize:} \quad&& \emptyset \cdot x\\
        & \text{subject to:} && x \succeq 0 \\
        & && M \cdot x = \probvec^{\mscenario}
    \end{aligned}
    \end{equation}
    If this ``optimization''\footnote{``Optimization'' is presented in quotes here because the minimization objective is trivially always zero ($\emptyset$ denotes the null vector of all zero entries). The primal value of the linear program is of no interest, all that matters is its \textit{feasibility}.} is \textit{feasible}, then there exists a vector $x$ than can satisfy \cref{eq:incidence_matrix_use} and is a valid joint distribution vector. Therefore, feasibility of the marginal linear program not only implies that $\probvec^{\jointvar}$ exists but returns $\probvec^{\jointvar}$. Moreover if the marginal linear program is \textit{infeasible}, then there \textit{does not} exist a joint distribution $\probvec^{\jointvar}$. To every linear program, there exists a dual linear program that characterizes the feasibility of the original~\cite{Schrijver_1998}. Constructing the dual linear program is straightforward~\cite{Lahaie_2008}.
    \begin{equation}
    \begin{aligned}
        & \text{minimize:} \quad&& y \cdot \probvec^{\mscenario}\\
        & \text{subject to:} && y \cdot M \succeq 0
    \end{aligned}
    \end{equation}

    The dual marginal linear program not only answers the marginal problem for a specific marginal model $\probvec^{\mscenario}$ but as a by-product provides an inequality that witnesses its contextuality. If this is not obvious, first notice that the dual problem is \textit{never infeasible}; by choosing $y$ to be trivially the null vector $\emptyset$ of appropriate size, all constraints become satisfied. Secondly if the dual constraint $y \cdot M \succeq 0$ holds \textit{and} the primal is feasible, then $y \cdot \probvec^{\mscenario} =  y \cdot M \cdot x \geq 0$. Therefore the \textit{sign} of the dual objective $d \defined \min \br{y \cdot \probvec^{\mscenario}}$ classifies a marginal model's contextuality; if $d < 0$ then $y \cdot \probvec^{\mscenario} \geq 0$ is violated and therefore $\probvec^{\mscenario}$ is contextual. Likewise if $d \geq 0$ (satisfying $y \cdot \probvec^{\mscenario}$), then $\probvec^{\mscenario}$ is non-contextual.\footnote{Actually, if $d \geq 0$ then it is exactly $d = 0$ due to the existence of the trivial $y = \emptyset$. This observation is an instance of the \textit{Complementary Slackness Property} of~\cite{Bradley_1977}. Moreover, if $d < 0$, then it is unbounded $d = -\inf$. This latter point becomes clear upon recognizing that for any $y$ with $d < 0$, another $y' = \al y$ can be constructed (with $\al > 1$) such that $d' = \al d < d$. Since a more negative $d'$ can always be found, it must be that $d$ is unbounded. This is a demonstration of the fundamental \textit{Unboundedness Property} of~\cite{Bradley_1977}; if the dual is unbounded, then the primal is infeasible.} This is manifestation of Farkas's lemma~\cite{Schrijver_1998}. An \term{infeasibility certificate}~\cite{Andersen_2001} is any vector $y$ that satisfies the $y \cdot M \succeq 0$. Most linear program software packages such as Mosek~\cite{Mosek_2016}, Gurobi~\cite{Gurobi_2016}, CPLEX~\cite{Cplex_2016} and CVX/CVX OPT~\cite{CVX_2016,CVX_Opt_2016} are capable of producing infeasibility certificates. Furthermore, for every $y$ satisfying $y \cdot M \succeq 0$ there corresponds a \term{certificate inequality} that constraints the set of non-contextual marginal models. If $y$ is an infeasibility certificate, then $y \cdot \probvec^{\mscenario} \geq 0$ is satisfied by all contextual marginal models.

    The marginal problem can sometimes take on a more general variant that does not begin with a specific marginal model~\cite{Abramsky_2012,Mansfield_2012,Fritz_2011}: \textit{Given a marginal scenario $\mscenario$, what is the set of all non-contextual marginal models?} \citet{Pitowsky_1991} demonstrates that the set of non-contextual marginal models forms a \textit{convex} polytope called the \term{marginal polytope}. The extremal rays of a marginal polytope directly correspond to the columns of $M$ which further correspond to \textit{deterministic} joint distributions $\probvec^{\jointvar}$. Since all joint distributions $\probvec^{\jointvar}$ are probability distributions, their entries must sum to unity $\sum_{j \in \Events{\jointvar}} \probvec^{\jointvar}_j = 1$. This normalization defines the convexity of the polytope; all non-contextual marginal models are convex mixtures of the deterministic marginal models pursuant to \cref{eq:incidence_matrix_use}. The marginal polytope is a beneficial tool for understanding contextuality. First, the \textit{facets} of a marginal polytope correspond to a finite set of linear inequalities that are complete in the sense that all contextual distributions violate at least one facet inequality~\cite{Brunner_2013}. From the perspective of a marginal polytope, convex hull algorithms or linear quantifier elimination can be used to compute a representation of the complete set of linear inequalities and completely solve the marginal problem. A popular tool for linear quantifier elimination is \term{Fourier-Motzkin elimination} \cite{Dantzig_1973,Inflation,Abramsky_2012,jones_2004}. Applying the Fourier-Motzkin procedure to completely solve the marginal problem is discussed in more detail in \citet{Fritz_2011}. An excellent survey of existing techniques for solving the marginal problem including Equality Set Projection~\cite{jones_2004} and Hardy-type hypergraph transversals can be found in \citet{Inflation}. In conclusion, there are a number of computational tools available to solve the marginal problem completely whenever no marginal model is provided.

    Each of the above mentioned techniques suffers from computational complexity limitations. For example, the Fourier-Motzkin procedure is in the worst case doubly exponential in the number of initial inequalities~\cite{Dantzig_1973}. For the purposes of this research, solving the marginal problem without reference to a marginal model was intractable. This will become apparent in \cref{sec:deriving_inequalities} when the Inflation Technique is applied to the Triangle structure, producing considerably large marginal models. Luckily, the Fritz distribution allows one to avoid the complexity issues of the complete marginal problem and instead focus on the original problem of determining whether or not a particular marginal model admits a joint distribution or not.

    \section{Inflation Technique}
    \label{sec:inflation_technique_summary}
    The \term{Inflation Technique}, invented by \citet{Inflation} and inspired by the \textit{do calculus} and \textit{twin networks} of \citet{Pearl_2009}, is a family of causal inference techniques that can be used to determine if an observable probability distribution $\prob[\nodes_{O}]$ is compatible or incompatible with a given causal structure $\graph$. As a precursor, the Inflation Technique begins by \textit{augmenting} a causal structure $\graph$ with additional copies of its nodes, producing an \textit{inflated} causal structure $\graph'$ called an \term{inflation}, and then exposes how causal inference tasks on the inflation can be used to make inferences on the original causal structure. For reference, a few inflations of the Triangle structure are depicted in \cref{fig:inflations}. Copies of nodes in the inflated causal structure are distinguished by an additional subscript called the \term{copy-index}. For example, node $A$ of \cref{fig:triangle_structure} has copies $A_1, A_2, A_3, A_4$ in the inflated causal structure in \cref{fig:the_web_inflation}. All such copies are deemed equivalent via a \term{copy-index equivalence} relation denoted `$\sim$'. A copy-index is effectively arbitrary, so we will refer to an arbitrary inflated copy of $A$ as $A'$, i.e. $A \sim A_1 \sim A' \not\sim B \sim B_1 \sim B'$.\footnote{Note that we preemptively generalize the notion of copy-index equivalence to other mathematical objects like sets, graphs, and groups by saying that $X \sim Y$ if and only if $X$ is equivalent to $Y$ upon removal of the copy-index.}

    \begin{nscenter}
    \begin{figure}
    \begin{subfigure}[b]{.30\linewidth}
    \scalebox{0.65}{\input{figures/causal_structures/inflated_triangle_structure_spiral}}
    \caption{The Spiral inflation.}\label{fig:spiral_inflation}
    \end{subfigure}
    \begin{subfigure}[b]{.30\linewidth}
    \scalebox{0.65}{\input{figures/causal_structures/inflated_triangle_structure_wagon_wheel}}
    \caption{The Wagon-Wheel inflation.}\label{fig:wagon_wheel_inflation}
    \end{subfigure}
    \begin{subfigure}[b]{.30\linewidth}
    \scalebox{0.65}{\input{figures/causal_structures/inflated_triangle_structure}}
    \caption{The Web Inflation.}\label{fig:the_web_inflation}
    \end{subfigure}
    \caption{Some inflations of the Triangle structure.}
    \label{fig:inflations}
    \end{figure}
    \end{nscenter}

    In addition to the common graph-theoretic terminology and notation presented in \cref{sec:causal_compatibility}, two related concepts need introductions. First, an \term{induced subgraph} of $\graph$ for a subset of nodes $N \subseteq \nodes$ is the graph composed of nodes $N$ and all edges $e$ of the original graph that are contained in $N$: $\Sub[\graph]{N} \defined \br{N, \bc{e = \bc{n \to m} \mid n, m \in N}}$. An \term{ancestral subgraph} of $\graph$ for a subset of nodes $N \subseteq \nodes$ is the induced subgraph due to the ancestry of $N$: $\AnSub[\graph]{N} \defined \Sub[\graph]{\An[\graph]{N}}$.

    The Inflation Technique begins with distribution $\prob[N]$ defined over some observable nodes $N$ of $\graph$ and the a priori assumption that it is compatible with $\graph$ pursuant to the definitions provided in \cref{sec:causal_compatibility}. Regarding $\graph$ as a causal hypothesis, the observable correlation $\prob[N]$ can only be influenced by the ancestry of $N$ in $\graph$. Consequently, for any set of nodes $N'$ of an inflation $\graph'$ where the ancestral subgraph $\AnSub[\graph']{N'}$ happens to be homomorphic to the ancestral subgraph $\AnSub[\graph]{N}$, one can conclude that the distribution $\prob[N']$ (induced by $\prob[N]$\footnote{The inflated distribution $\prob[N']$ assigns the same probability to all events of $\prob[N]$ whenever the events are equivalent under the removal of copy-indices.}) is compatible with $\graph'$ using the same latent explanations for $\prob[N]$ in $\graph$. This observation is known as the \term{Inflation Lemma}~\cite[Lemma 3]{Inflation}.

    To formalize the Inflation Lemma, we define the \term{injectable sets of $\graph'$}, denoted $\Inj[\graph]{\graph'}$, as all sets of nodes in $\graph'$ whose ancestral subgraphs are homomorphic (via copy-index removal) to an ancestral subgraph in $\graph$: $\Inj[\graph]{\graph'} \defined \bc{N' \subseteq \nodes' \mid \exists N \subseteq \nodes : \AnSub[\graph']{N'} \sim \AnSub[\graph]{N}}$. Analogously defined are the \term{images of the injectable sets in $\graph$}: $\ImInj[\graph]{\graph'} \defined \bc{N \subseteq \nodes \mid \exists N' \subseteq \nodes' : \AnSub[\graph']{N'} \sim \AnSub[\graph]{N}}$.

    To illustrate these concepts, consider the Spiral inflation $\graph'$ depicted in \cref{fig:spiral_inflation}. The ancestral subgraph of $\bc{A_1}$ in the Spiral inflation (denoted $\AnSub[\graph']{\bc{A_1}}$) is highlighted in \cref{fig:spiral_inflation_inj1} and is clearly homomorphic to the ancestral subgraph of its image $\bc{A}$ in the Triangle structure ($\graph$) (\cref{fig:spiral_inflation_iminj1}). Additionally, the set $\bc{A_2, C_1}$ is an injectable set of $\graph'$ because $\AnSub[\graph']{\bc{A_2, C_1}}$ (highlighted in \cref{fig:spiral_inflation_inj2}) is homomorphic (via copy-index removal) to the $\AnSub[\graph]{\bc{A, C}}$ in the Triangle structure $(\graph)$ (\cref{fig:spiral_inflation_iminj2}).

    \begin{nscenter}
    \begin{figure}
    \begin{subfigure}[b]{.23\linewidth}
    \scalebox{0.8}{\input{figures/causal_structures/inflated_triangle_structure_spiral_injectable_highlight_1}}
    \caption{$\AnSub[\graph']{\bc{A_1}}$}\label{fig:spiral_inflation_inj1}
    \end{subfigure}
    \begin{subfigure}[b]{.23\linewidth}
    \scalebox{0.8}{\input{figures/causal_structures/triangle_structure_injectable_highlight_1}}
    \caption{$\AnSub[\graph]{\bc{A}}$}\label{fig:spiral_inflation_iminj1}
    \end{subfigure}
    % \par\bigskip % For vertical spacing https://tex.stackexchange.com/questions/120700/vertical-spacing-using-subcaption-package
    \begin{subfigure}[b]{.23\linewidth}
    \scalebox{0.8}{\input{figures/causal_structures/inflated_triangle_structure_spiral_injectable_highlight_2}}
    \caption{$\AnSub[\graph']{\bc{A_2, C_1}}$}\label{fig:spiral_inflation_inj2}
    \end{subfigure}
    \begin{subfigure}[b]{.23\linewidth}
    \scalebox{0.8}{\input{figures/causal_structures/triangle_structure_injectable_highlight_2}}
    \caption{$\AnSub[\graph]{\bc{A,C}}$}\label{fig:spiral_inflation_iminj2}
    \end{subfigure}
    \caption{Some injectable sets $\Inj[\graph]{\graph'}$ of the Spiral inflation ($\graph'$) and their corresponding images $\ImInj[\graph]{\graph'}$ in the Triangle structure ($\graph$).}
    \label{fig:injectablesets}
    \end{figure}
    \end{nscenter}
    % \begin{definition}
    %     Given a causal structure $\graph$ and an inflation $\graph'$ of $\graph$, define the \term{injectable sets} in $\graph'$ and the \term{images of the injectable sets} in $\graph$, (respectively denoted $\Inj[\graph]{\graph'}$ and $\ImInj[\graph]{\graph'}$), as follows:
    %     \begin{align*}
    %         \Inj[\graph]{\graph'} &\defined \bc{N' \subseteq \nodes' \mid \exists N \subseteq \nodes : \AnSub[\graph']{N'} \sim \AnSub[\graph]{N}} \\
    %         \ImInj[\graph]{\graph'} &\defined \bc{N \subseteq \nodes \mid \exists N' \subseteq \nodes' : \AnSub[\graph']{N'} \sim \AnSub[\graph]{N}}
    %     \end{align*}
    % \end{definition}


    % \begin{lemma}
    %     \label[lemma]{lem:inflation}
    %     \term{The Inflation Lemma}~\cite[Lemma 3]{Inflation} Given a particular inflation $\graph'$ of $\graph$ and a marginal model $\prob^{\ImInj[\graph]{\graph'}}$ compatible with $\graph$ then all marginal models $\prob^{\Inj[\graph]{\graph'}}$ are compatible with $\graph'$ provided that $\prob[N] = \prob[N']$ for all instances where $N \sim N'$.
    % \end{lemma}

    % \begin{proof}
    %     Given that $\prob^{\ImInj[\graph]{\graph'}}$ is compatible with $\graph$, it admits a joint distribution $\prob[\nodes]$ that can be factorized into its causal parameters $\prob[\nodes] = \prod_{n \in \nodes} \prob[n\mid \Pa[\graph]{n}]$. Given \cref{eq:inflation_defn}, one can create a set of \textit{inflated} causal parameters by matching causal parameters according to respective copy-indices: $\forall n' \in \nodes' : \prob[n'\mid \Pa[\graph']{n'}] \defined \prob[n\mid \Pa[\graph]{n}]$. This uniquely induces a compatible joint distribution $\prob[\nodes']$ on $\graph'$\footnote{Of course, there exists compatible joint distributions on $\nodes'$ that can not be constructed in this manner. The claim is that all joint distributions that are constructed in this way are compatible.}: $\prob[\nodes'] = \prod_{n' \in \nodes'} \prob[n'\mid \Pa[\graph']{n'}]$. The proof is completed by demonstrating that the marginals of $\prob[\nodes']$ are members of the marginal model $\prob^{\Inj[\graph]{\graph'}}$ provided that $\prob[N] = \prob[N']$ for all instances where $N \sim N'$. Given $N' \in \Inj[\graph]{\graph'}$ and $N \sim N'$:
    %     \[ \sum_{\nodes' \setminus N'} \prob[\nodes'] = \sum_{\nodes' \setminus N'} \prod_{n' \in \nodes'} \prob[n'\mid \Pa[\graph']{n'}] = \prod_{n' \in N'} \prob[n'\mid \Pa[\graph]{n'}] = \prod_{n \in N} \prob[n\mid \Pa[\graph]{n}] = \prob[N] = \prob[N']  \]
    % \end{proof}

    % The motivation behind \cref{def:inflation} is that if the ancestry of each node $n'$ in $\graph'$ plays the \textit{exact same} role as the ancestry of its source copy $n$ in $\graph$, then every compatible distribution $\prob[N]$ on $\graph$ can be used to \textit{create} compatible joint distributions on $\graph'$. To do this, first notice that for every distribution $\prob[N]$ compatible with $\graph$, there must exist a set of causal parameters $\{\prob[n\mid \Pa[\graph]{n}] \mid n \in \nodes\}$ for $\graph$ such that $\prob[N] = \prod_{n \in N} \prob[n\mid \Pa[\graph]{n}]$. Since the inflation criteria (\cref{eq:inflation_defn}) requires that $\Pa[\graph']{n'} \sim \Pa[\graph]{n}$.
    % \[ ss \eq \label{eq:inflated_causal_parameters} \]
    % \[ \prob[\nodes'] = \prod_{n' \in \nodes'} \prob[n'\mid \Pa[\graph']{n'}] \eq \label{eq:unique_causal_parameters_inflated}\]

    % % \cref{eq:unique_causal_parameters,eq:inflated_causal_parameters,eq:unique_causal_parameters_inflated}
    % In essence, a compatible joint distribution over $\nodes$ can be \textit{inflated} to induce compatible joint distributions over $\nodes'$. Before generalizing this idea, a careful observation needs to be made. For any pair of subsets of nodes $N \subseteq \nodes$ and $N' \subseteq \nodes'$ that are equivalent up to copy-index $N \sim N'$, if $\AnSub[\graph]{N} \sim \AnSub[\graph']{N'}$ then any compatible \textit{marginal} distribution $\prob[N]$, where $N \subset \nodes$, induces a compatible marginal distribution $\prob[N']$ over $N'$. In fact, $N'$ must contain no duplicate nodes up to copy-index and thus $\prob[N] = \prob[N']$. These subsets of nodes are so essential to the Inflation Technique they are assigned a special name:

    % % Injectable sets are incredibly useful for causal compatibility because they permit one to inflate compatibility over a particular subset of \textit{marginal models}. A marginal model is compatible with a given causal structure $\graph$ if it admits a joint distribution (see \cref{sec:marginal_satisfiability}) that is compatible with $\graph$.

    % % Diagrammatically, \cref{lem:inflation} can be visualized as follows:

    % % \begin{nscenter}
    % %     \begin{tikzpicture}
    % %         \pgfmathsetmacro{\vs}{2.2};
    % %         \pgfmathsetmacro{\hs}{5.2};
    % %         \draw (0*\hs,0*\vs) node[](pn){$\underbrace{\bc{\prob[N] \mid N \in \ImInj[\graph]{\graph'}}}_{\text{compatible with $\graph$}}$};
    % %         \draw (1*\hs,0*\vs) node[](cp){$\bc{\prob[n\mid \Pa[\graph]{n}] \mid n \in \nodes}$};
    % %         \draw (1*\hs,-1*\vs) node[](cp_){$\bc{\prob[n'\mid \Pa[\graph']{n'}] \mid n' \in \nodes'}$};
    % %         \draw (0*\hs,-1*\vs) node[](pn_){$\underbrace{\bc{\prob[N'] \mid N' \in \Inj[\graph]{\graph'}}}_{\text{compatible with $\graph'$}}$};
    % %         \draw[very thick, ->] (pn) -- (cp);
    % %         \draw[very thick, ->] (cp) -- (cp_) node [midway, above, sloped]{{\footnotesize define}};
    % %         \draw[very thick, ->] (cp_) -- (pn_);
    % %     \end{tikzpicture}
    % % \end{nscenter}

    % The inflation lemma is the most important result of the causal Inflation Technique. The contrapositive version of \cref{lem:inflation} is a powerful tool for deriving causal compatibility constraints. Any causal compatibility constraint, such as a causal compatibility inequality, that constrains injectable marginal models $\bc{\prob[N'] \mid N' \in \Inj[\graph]{\graph'}}$ can be \textit{deflated} into a valid compatibility constraint on marginal models $\bc{\prob[N] \mid N \in \ImInj[\graph]{\graph'}}$ of the original causal structure by dropping all references to the copy-indices. Additionally, the inflation lemma holds when considering any subset of $\Inj[\graph]{\graph'}$ (analogously $\ImInj[\graph]{\graph'}$). Therefore, one only needs to consider injectable sets that are composed of \textit{observable nodes}.

    The injectable sets of an inflation are of \textit{principle importance} to the Inflation Technique. Given a distribution $\prob[\nodes_{O}]$ defined over the observable nodes of $\graph$, one can compute a marginal model defined over the injectable sets $\prob^{\Inj[\graph]{\graph'}} = \bc{\prob[N'] \mid N' \in \Inj[\graph]{\graph'}}$ and their images $\prob^{\ImInj[\graph]{\graph'}} = \bc{\prob[N] \mid N \in \ImInj[\graph]{\graph'}}$. The contrapositive of the Inflation Lemma casts the compatibility problem for $\prob^{\ImInj[\graph]{\graph'}}$ (which exhibits equivalent compatibility as $\prob[\nodes_O]$) into a compatibility problem for $\prob^{\Inj[\graph]{\graph'}}$ of any non-trivial inequalities. If $\prob^{\Inj[\graph]{\graph'}}$ is found to be incompatible with $\graph'$, then $\prob^{\ImInj[\graph]{\graph}}$ (and also $\prob[\nodes_O]$) must be incompatible with $\graph$. Fortunately, the inflated causal structure $\graph'$ possesses its own \textit{d-separation relations} which enforces conditional independence equality constraints on $\prob^{\Inj[\graph]{\graph'}}$. A useful subset of d-separation relations are those corresponding to unconditional d-separations, known as \term{ancestrally independent} sets~\cite{Pearl_2009}. Two sets $N_1', N_2'$ are ancestrally independent ($N_1' \ancestralindep N_2'$) if they have distinct ancestry in $\graph'$.
    \[ N_1' \ancestralindep N_2' \iff \An[\graph']{N_1'} \cap \An[\graph']{N_2'}= \emptyset \eq \]
    Ancestral independence implies an unconditional probabilistic independence --- if $N_1' \ancestralindep N_2'$ then $\prob[N_1' \cup N_2'] = \prob[N_1']\prob[N_2']$. If $N_1', N_2' \in \Inj[\graph]{\graph'}$, then the associated probabilistic constraint is applicable to $\prob^{\Inj[\graph]{\graph'}}$. This notion generalizes to more than two ancestrally independent sets. A set $N' \subseteq \nodes'$ is an \term{ai-expressible set} if it can be decomposed into the disjoint union of injectable sets $N' = \coprod_{i} N'_i \mid N'_i \in \Inj[\graph]{\graph'}$ and all pairs $N_i', N_j'$ are ancestrally independent: $\forall i, j : N_i' \ancestralindep N_j'$. The analogous probabilistic constraint is: $\prob[N'] = \prob[\coprod_i N'_i] = \prod_{i}\prob[N'_i]$~\cite{Pearl_2009}.\footnote{In~\cite{Inflation}, this concept is generalized into terms which can be factorized via d-separation conditions and the corresponding inflated sets are termed \textit{expressible sets}. This generalization was not required for this work in particular because the ancestral independence relations formed a generating set of d-separation conditions for all of the inflations considered in \cref{fig:inflations}.} Throughout this work, we let $\AIExpr[\graph]{\graph'}$ denote the set of all ai-expressible sets.\footnote{Analogously to a marginal scenario $\mscenario$, the ai-expressible sets $\AIExpr[\graph]{\graph'}$ form an \textit{abstract simplicial complex}. Therefore, in practice, it is completely sufficient to focus on the \textit{maximal} ai-expressible sets.} Efficient algorithms for computing the injectable and ai-expressible sets of an inflation can be found in~\cite{Inflation}. \Cref{tab:asexpr_triangle_structure_wagon_wheel,tab:asexpr_triangle_structure_web} tabulate the ai-expressible sets and the associated ancestral separations for the Wagon-Wheel and Web inflations (respectively \cref{fig:wagon_wheel_inflation,fig:the_web_inflation}).

    \begin{nscenter}
        \begin{table}
        \parbox{.45\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
                \hline
                \multicolumn{2}{|c|}{Maximally AI-Expressible Sets} \\
                \multicolumn{2}{|c|}{for the Wagon-Wheel Inflation} \\
                \hline
                $\AIExpr[\graph]{\graph'}$ & Ancestral Separations \\
                \hline
                $\bc{A_2, B_1, C_3, C_1}$ & $\bc{A_2, B_1, C_3} \ancestralindep \bc{C_1}$ \\
                $\bc{A_1, B_1, C_4, C_2}$ & $\bc{A_1, B_1, C_4} \ancestralindep \bc{C_2}$ \\
                $\bc{A_1, B_2, C_1, C_3}$ & $\bc{A_1, B_2, C_1} \ancestralindep \bc{C_3}$ \\
                $\bc{A_2, B_2, C_2, C_4}$ & $\bc{A_2, B_2, C_2} \ancestralindep \bc{C_4}$ \\
                \hline
            \end{tabular}
            \caption{The maximally ai-expressible sets for the Wagon-Wheel Inflation.
            \label{tab:asexpr_triangle_structure_wagon_wheel}}
        }
        \hfill
        \parbox{.45\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
                \hline
                \multicolumn{2}{|c|}{Maximally AI-Expressible Sets} \\
                \multicolumn{2}{|c|}{for the Web Inflation} \\
                \hline
                $\AIExpr[\graph]{\graph'}$ & Ancestral Separations \\
                \hline
                $\bc{A_1, B_1, C_1, A_4, B_4, C_4}$ & $\bc{A_1, B_1, C_1} \ancestralindep \bc{A_4, B_4, C_4}$ \\
                $\bc{A_1, B_2, C_3, A_4, B_3, C_2}$ & $\bc{A_1, B_2, C_3} \ancestralindep \bc{A_4, B_3, C_2}$ \\
                $\bc{A_2, B_3, C_1, A_3, B_2, C_4}$ & $\bc{A_2, B_3, C_1} \ancestralindep \bc{A_3, B_2, C_4}$ \\
                $\bc{A_2, B_4, C_3, A_3, B_1, C_2}$ & $\bc{A_2, B_4, C_3} \ancestralindep \bc{A_3, B_1, C_2}$ \\
                $\bc{A_1, B_3, C_4}$ & $\bc{A_1} \ancestralindep \bc{B_3} \ancestralindep \bc{C_4}$ \\
                $\bc{A_1, B_4, C_2}$ & $\bc{A_1} \ancestralindep \bc{B_4} \ancestralindep \bc{C_2}$ \\
                $\bc{A_2, B_1, C_4}$ & $\bc{A_2} \ancestralindep \bc{B_1} \ancestralindep \bc{C_4}$ \\
                $\bc{A_2, B_2, C_2}$ & $\bc{A_2} \ancestralindep \bc{B_2} \ancestralindep \bc{C_2}$ \\
                $\bc{A_3, B_3, C_3}$ & $\bc{A_3} \ancestralindep \bc{B_3} \ancestralindep \bc{C_3}$ \\
                $\bc{A_3, B_4, C_1}$ & $\bc{A_3} \ancestralindep \bc{B_4} \ancestralindep \bc{C_1}$ \\
                $\bc{A_4, B_1, C_3}$ & $\bc{A_4} \ancestralindep \bc{B_1} \ancestralindep \bc{C_3}$ \\
                $\bc{A_4, B_2, C_1}$ & $\bc{A_4} \ancestralindep \bc{B_2} \ancestralindep \bc{C_1}$ \\
                \hline
            \end{tabular}
            \caption{The maximally ai-expressible sets for the Web Inflation.
            \label{tab:asexpr_triangle_structure_web}}
        }
        \end{table}
    \end{nscenter}

    Unlike $\prob^{\ImInj[\graph]{\graph'}}$, which is non-contextual by construction, $\prob^{\Inj[\graph]{\graph'}}$ contains overlapping marginals meaning its contextuality remains unknown and must be determined using any of the techniques discussed in~\cref{sec:marginal_satisfiability}. More importantly, the Inflation Technique introduces new constraints relating to the ai-expressible sets. In practice, the equality constraints implied by $\AIExpr[\graph]{\graph'}$ permits one to construct a marginal model defined over the ai-expressible sets $\AIExpr[\graph]{\graph'}$ resulting in greater resolution in classifying the compatibility of $\prob[\nodes_O]$. In summary, the Inflation Technique partially transforms the compatibility problem into a marginal problem, wherein one can solve the marginal problem (\cref{sec:marginal_satisfiability}) to either determine the compatibility of an observable distribution $\prob[\nodes_O]$ with $\graph$ or derive compatibility inequalities for $\graph$ --- the latter of which is discussed in \cref{sec:deriving_inequalities}.


    % that are used to derive inequalities using methods discussed in \cref{sec:marginal_satisfiability}.

    % \begin{nscenter}
    %     \begin{tikzpicture}[scale=0.8]
    %         \pgfmathsetmacro{\hs}{1.4};
    %         \pgfmathsetmacro{\vs}{0.6};
    %         \pgfmathsetmacro{\cross}{0.2};
    %         \draw (0*\hs, 4*\vs) node[](a){$\prob[N']$};
    %         \draw (0*\hs, 2*\vs) node[](ab){$N' \not \in \Inj[\graph]{\graph'}$};
    %         \draw (4*\hs, 4*\vs) node[](c){$\prob[N_1']\prob[N_2']$};
    %         \draw (2*\hs, 4*\vs) node[](ac){$N_1' \ancestralindep N_2'$};
    %         \draw (2*\hs, 4*\vs + 0.7*\vs) node[]{$N_1' \cup N_2' = N$};
    %         \draw (4*\hs, 2*\vs) node[](cd){$N_1', N_2' \in \Inj[\graph]{\graph'}$};
    %         \draw (4*\hs, 0*\vs) node[](d){$\prob[N_1]\prob[N_2]$};
    %         \draw (0, 0) node[](b){??};
    %         \draw[thick, ] (a) -- (ab);
    %         \draw[thick, ] (c) -- (cd);
    %         \draw[thick, ] (a) -- (ac);
    %         \draw[thick, ->] (ac) -- (c);
    %         \draw[thick, ->] (ab) -- (b);
    %         \draw[thick, ->] (cd) -- (d);
    %         \draw[very thick, red]
    %         (+ \cross, 1*\vs + \cross) -- (- \cross, 1*\vs - \cross)
    %         (+ \cross, 1*\vs - \cross) -- (- \cross, 1*\vs + \cross)
    %         ;
    %     \end{tikzpicture}
    % \end{nscenter}

    % Not all sets $N' \subseteq \nodes'$ can be written as the disjoint union of injectable sets, but those that \textit{can} are called the \term{ai-expressible sets} of $\graph'$.

    % A ai-expressible set $N'$ is of primal importance to the Inflation Technique because any distribution over $N'$ will factorize according to its ancestral independence conditions
    % \[  \]
    % Application of the inflation lemma to linear inequalities constraining ai-expressible distributions $\prob[N']$ transforms those inequalities into polynomial inequalities over the injectable distributions, allowing one to replace all terms with probability distributions defined over variables in $\nodes$.

    \section{Deriving Inequalities from the Inflation Technique}
    \label{sec:deriving_inequalities}

    \Cref{sec:inflation_technique_summary} summarizes how the Inflation Technique~\cite{Inflation} can cast the compatibility problem into the marginal problem by leveraging inflations of the Triangle structure. Explicitly, for a given inflation $\graph'$ of the Triangle structure, one constructs a marginal problem (\cref{sec:marginal_satisfiability}) for the marginal scenario $\mscenario$ composed of the maximal ai-expressible sets of $\graph'$, i.e. $\mscenario = \AIExpr[\graph]{\graph'}$.

    Recall that the first inequality (\cref{eq:ww_ineq}) presented in \cref{sec:found_inequalities} was derived using the Wagon-Wheel inflation (\cref{fig:wagon_wheel_inflation}). The Wagon-Wheel inflation possesses $4$ copies of $C$ ($C_1, C_2, C_3, C_4$) and $2$ copies of $A$ ($A_1, A_2$) and $B$ ($B_1, B_2$) arranged in the shape of a Wagon-Wheel. The maximal ai-expressible sets of the Wagon-Wheel inflation along with their ancestral dependences can be found in \cref{tab:asexpr_triangle_structure_wagon_wheel}. These maximal ai-expressible sets define a marginal scenario where the joint variables $\jointvar$ are the set of observable nodes in the Wagon-Wheel inflation $\jointvar = \nodes'_O$:
    \[ \mscenario = \AIExpr[\graph]{\graph'} = \bc{\bc{A_2, B_1, C_3, C_1}, \bc{A_1, B_1, C_4, C_2}, \bc{A_1, B_2, C_1, C_3}, \bc{A_2, B_2, C_2, C_4}} \eq \label{eq:wagon_wheel_marginal_model}\]
    Given that the Fritz distribution is defined over $4$-outcomes variables, the variables in the marginal scenario are assigned $4$-outcomes as well. This marginal scenario $\mscenario$ then defines an incidence matrix $M$ capable of accommodating the Fritz distribution that has $\abs{\Events{\mscenario}} = 4 \cdot 4^{4} = 1024$ rows and $\abs{\Events{\jointvar}} = 4^8 = 65,536$ columns --- this matrix is not reproduced here. The sheer size of the incidence matrix used here makes complete solutions of the marginal problem using tools such as linear-quantifier elimination intractable. To construct the marginal distribution vector $\probvec^{\mscenario}$ for the Fritz distribution, one begins with $\probvec^{\mscenario}$ defined in a \textit{symbolic} form,
    \[ {\probvec^{\mscenario}}^{\intercal} = \underbrace{\br{\prob[A_2B_1C_3C_1]\br{0000}, \ldots, \prob[A_1B_1C_4C_2]\br{3232}, \ldots, \prob[A_2B_2C_2C_4]\br{3333}}}_{1024 \text{ entries}} \eq \label{eq:marginal_vector_wagon_wheel} \]
    Which can be factored into the ancestrally independent injectable sets using \cref{tab:asexpr_triangle_structure_wagon_wheel},
    \[ {\probvec^{\mscenario}}^{\intercal} = \br{\prob[A_2B_1C_3]\br{000}\prob[C_1]\br{0}, \ldots, \prob[A_1B_1C_4]\br{323}\prob[C_2]\br{2}, \ldots, \prob[A_2B_2C_2]\br{333}\prob[C_4]\br{3}} \eq \label{eq:marginal_vector_wagon_wheel_factors}\]
    And penultimately, each probability distribution in \cref{eq:marginal_vector_wagon_wheel_factors} is deflated by dropping copy-indices.
    \[ {\probvec^{\mscenario}}^{\intercal} = \br{\prob[ABC]\br{000}\prob[C]\br{0}, \ldots, \prob[ABC]\br{323}\prob[C]\br{2}, \ldots, \prob[ABC]\br{333}\prob[C]\br{3}} \eq \label{eq:marginal_vector_wagon_wheel_factors_dropped}\]
    This step is permitted because all of the remaining distributions in \cref{eq:marginal_vector_wagon_wheel_factors} are defined over the injectable sets of the Wagon-Wheel inflation. Finally, each of the elements of $\probvec^{\mscenario}$ are replaced with numerical values pursuant to the Fritz distribution. For example, $\prob[ABC]\br{323}\prob[C]\br{2}$ is assigned the following numerical value:
    \[ \prob[ABC]\br{323}\prob[C]\br{2} = \f{1}{32}\br{2 + \sqrt{2}} \cdot \f{1}{4} \simeq 0.0267 \eq \]
    The same is applied to all other entries of $\probvec^{\mscenario}$. Finally, this numerical version of $\probvec^{\mscenario}$ and $M$ are subjected to linear programing software and an infeasibility certificate $y$ was obtained, corresponding precisely to \cref{eq:ww_ineq} using \cref{eq:marginal_vector_wagon_wheel_factors_dropped} in bit-wise notation.

    The remaining inequalities in \cref{sec:found_inequalities} were derived using the Web inflation of \cref{fig:the_web_inflation}. The maximal ai-expressible sets of the Wagon-Wheel inflation along with their ancestral dependences can be found in \cref{tab:asexpr_triangle_structure_web}. Analogously to the Wagon-Wheel inflation, these ai-expressible sets form a marginal scenario $\mscenario$ which defines an incidence matrix $M$ that has $\abs{\Events{\mscenario}} = 4 \cdot 4^{6} + 8 \cdot 4^3 = 16,896$ rows, $\abs{\Events{\jointvar}} = 4^{12} = 16,777,216$ columns and $201,326,592$ non-zero entires.

    \section{Deriving Symmetric Causal Compatibility Inequalities}
    \label{sec:symmetric_inequalities}

    \Cref{sec:inflation_technique_summary} detailed how to obtain causal compatibility inequalities for any causal structure by constructing a corresponding marginal problem (as defined in \cref{sec:marginal_satisfiability}) and supplying an incompatible distribution to generate an infeasibility certificate. \cref{eq:symmetric_web_inequality} presented the causal compatibility inequality $I\tsb{SymmetricWeb}$ which is symmetric under permutations of the variables $A,B,C$. This section aims to describe a general technique that can be used to derive  $I\tsb{SymmetricWeb}$ and other inequalities also exhibiting this symmetry. In brief, this is accomplished by grouping marginal events $m \in \Events{\mscenario}$ of a marginal scenario $\mscenario$ into orbits under the action of variable permutations.

    Exploiting symmetries of the marginal scenario is useful for a few distinct reasons. First, \citet{Bancal_2010} discuss computational advantages in considering symmetric versions of marginal polytopes mentioned in \cref{sec:marginal_satisfiability}; the number of extremal points typically grows exponentially in $\jointvar$, but only polynomial for the symmetric polytope. They also note a number of interesting inequalities (such as CHSH~\cite{CHSH_Original}) can be written in a way that is symmetric under the exchange of parties, demonstrating that non-trivial inequalities can be recovered from facets of a symmetric polytope. Secondly, numerical optimizations against symmetric inequalities lead to one of two interesting cases: either the extremal distribution is symmetric itself or it is not. The latter case generates a family of incompatible distributions obtained by applying symmetry operations on the extremal distribution.\footnote{If the extremal distribution happens to be asymmetric, then one can conclude the space of accessible distributions is non-convex.}

    To clarify which symmetries we have in mind, first consider the marginal scenario $\mscenario = \bc{\bc{A, B, C}, \bc{C, D}, \bc{A, D}}$ where each variable in $\jointvar = \bc{A,B,C,D}$ has binary outcomes $\bc{0,1}$. ${I_{\mscenario} \defined \bc{\prob[ABC][010] \leq \prob[CD][00] + \prob[AD][01]}}$ is an inequality constraining the set of non-contextual marginal models $\prob^{\mscenario}$. Now, the contextuality of a distribution $\prob[ABCD]$ should be \textit{invariant} under those permutations of the variable labels in $\jointvar$  which map the marginal scenario to itself; but not all variable relabellings preserve $\mscenario$. An example of a permutation which does \emph{not} preserve $\mscenario$ is the $\varphi \in \Perm{\jointvar}$\footnote{The permutation group $\Perm{S}$ over a set $S$ is the set of all bijective maps $\varphi : S \to S$.} which acts like $\varphi\bs{\bc{a,b,c,d}} = \bc{c,a,d,b}$. Then, the action of $\varphi$ on $I_{\mscenario}$ is
    % Suppose $\varphi \in \Perm{\jointvar}$\footnote{The permutation group $\Perm{S}$ over a set $S$ is the set of all bijective maps $\varphi : S \to S$.} is a permutation of the variables $\jointvar$ such that $\varphi\bs{\bc{a,b,c,d}} = \bc{c,a,d,b}$. Intuitively $\varphi$ acts on $I_{\mscenario}$ in the following way,
    \begin{align*}
    \eq \label{eq:symmetry_example}
    \begin{split}
        \varphi\bs{I_{\mscenario}} &= \bc{\prob[\varphi\bs{abc}][010] \leq \prob[\varphi\bs{cd}][00] + \prob[\varphi\bs{ad}][01]} \\
        &= \bc{\prob[cad][010] \leq \prob[db][00] + \prob[cb][01]} \\
        &= \bc{\prob[acd][100] \leq \prob[bd][00] + \prob[bc][10]}
    \end{split}
    \end{align*}
    which yields a vali-but-irrelevant inequality, as the resulting inequality no longer pertains to  $\mscenario$%. In general, permutations over $\jointvar$ can modify the marginal scenario $\varphi\bs{\mscenario} \defined \bc{\varphi\bs{V_1}, \ldots, \varphi\bs{V_k}} \neq \mscenario$; this was the case for the above example. Therefore $\varphi$ has capacity to modify both the terms of the inequality as well as the set of marginal models it constrains $\varphi\bs{I_{\mscenario}} = \varphi\bs{I}_{\varphi\bs{\mscenario}}$.

    Permutations $\varphi$ that modify the marginal scenario have no application within the framework of the Inflation Technique (\cref{sec:inflation_technique_summary}) because the Inflation Lemma only holds when the inflated inequality constrains injectable sets. Therefore, the desired set of symmetries for our purposes is a subgroup of $\Perm{\jointvar}$ that takes $\mscenario$ to $\mscenario$.

    The \term{variable permutation group} $\gp\br{\mscenario}$ for a marginal scenario $\mscenario$ is the joint permutation subgroup that stabilizes the marginal scenario, $\Phi\br{\mscenario} \defined \bc{\varphi \in \Perm{\jointvar} \mid \forall V \in \mscenario : \varphi\bs{V} \in \mscenario}$.
    In general, the variable permutation group $\gp\br{\mscenario}$ can be obtained using group stabilizer algorithms. After obtaining $\gp\br{\mscenario}$, one can take known compatibility inequalities $I_{\mscenario}$ can create a whole family of inequalities $\bc{\varphi\bs{I_{\mscenario}} \mid \varphi \in \gp\br{\mscenario}}$ that are valid for the same marginal scenario $\varphi\bs{I_{\mscenario}} = \varphi\bs{I}_{\varphi\bs{\mscenario}} = \varphi\bs{I}_{\mscenario}$.

    Although useful for reducing computational complexity~\cite{Bancal_2010}, we divert our attention to finding \textit{symmetric} inequalities, i.e. those where $\forall \varphi \in \gp\br{\mscenario} :  \varphi\bs{I_{\mscenario}} = I_{\mscenario}$. To generate inequalities that exhibit certain symmetries using the methods described in \cref{sec:marginal_satisfiability}, it is sufficient to perform a change of basis on the incidence matrix $M$ for a given marginal scenario $\mscenario$. Through repeated action of $\varphi \in \gp$ on marginal outcomes $m \in \Events{\mscenario}$ and joint outcomes $j \in \Events{\jointvar}$, one can define \term{group orbits} of $\gp$ in $\Events{\mscenario}$ and $\Events{\jointvar}$; respectively $\Orb[\gp]{m} \defined \bc{\varphi\bs{m} \mid \varphi \in \gp}$, $\Orb[\gp]{j} \defined \bc{\varphi\bs{j} \mid \varphi \in \gp}$. The action of $\varphi \in \gp$ on any outcome $f \in \Events{V}$ (denoted $\geo\bs{f}$) is defined as $\br{\varphi\bs{f}}\br{v} \defined f\br{\varphi^{-1}\bs{v}}$ pursuant to intuitive action used in \cref{eq:symmetry_example}. Using these group orbits, it is possible to contract the incidence matrix $M$ of a marginal scenario into a symmetrized version. The \term{symmetric incidence matrix} $M_{\gp}$ for a marginal scenario $\mscenario$ and the variable permutation group $\gp$ is a contracted version of the incidence matrix $M$ for $\mscenario$. Each row of $M_{\gp}$ corresponds to a marginal orbit $\Orb[\gp]{m}$. Analogously each column of $M_{\gp}$ corresponds to a joint orbit $\Orb[\gp]{j}$. The entries of $M_{\gp}$ are integers and correspond to summing over the rows and columns of $M$ that belong to each orbit.
    \[ \br{M_{\gp}}_{\Orb[\gp]{m}, \Orb[\gp]{j}} = \sum_{\substack{j' \in \Orb[\gp]{j} \\ m' \in \Orb[\gp]{m}}} M_{m',j'} \eq \]
    It is possible to analogously define a \term{symmetric joint distribution vector} $\probvec^{\jointvar}_{\Phi}$ indexed by $\Orb[\gp]{j}$, $\br{\probvec^{\jointvar}_{\Phi}}_{\Orb[\gp]{j}} = \sum_{j' \in \Orb[\gp]{j}} \probvec^{\jointvar}_{j'}$ and a \term{symmetric marginal distribution vector} $\probvec^{\mscenario}_{\Phi}$ indexed by $\Orb[\gp]{m}$, $\br{\probvec^{\mscenario}_{\Phi}}_{\Orb[\gp]{m}} = \sum_{m' \in \Orb[\gp]{m}} \probvec^{\mscenario}_{m'}$. Together, $M_{\gp}, \probvec^{\jointvar}_{\Phi}$ and $\probvec^{\mscenario}_{\Phi}$ define a new, \term{symmetric marginal problem}: $\probvec^{\mscenario}_{\Phi} = M_{\gp} \cdot \probvec^{\jointvar}_{\Phi}$. The symmetric marginal problem can be solved using the same computational methods discussed in \cref{sec:marginal_satisfiability} and will produce symmetric inequalities.

    In the context of the Inflation Technique, a variable symmetry $\Phi\br{\mscenario'}$ over an inflated marginal scenario $\mscenario'$ does not always correspond to a variable symmetry under deflation $\Phi\br{\mscenario}$. In order to derive deflated inequalities that are symmetric under an exchange of parties, it is required that $\Phi\br{\mscenario'} \sim \Phi\br{\mscenario}$ are equivalent up to copy-index.

    For the Triangle structure in particular, the variable permutation group is the set of permutations on $A, B, C$: $\Phi\br{\mscenario} = \Perm{A, B, C}$. For the Web inflation (\cref{fig:the_web_inflation}), we have obtained $\gp\br{\AIExpr[\graph]{\graph'}}$ --- an order $48$ group with the following $4$ generators:
    \begin{equation}
    \begin{aligned}[c]
    &\hspace{1mm}\varphi_1 \\
    A_1 &\to A_4 \\A_2 &\to A_3 \\A_3 &\to A_2 \\A_4 &\to A_1 \\B_1 &\to B_4 \\B_2 &\to B_3 \\B_3 &\to B_2 \\B_4 &\to B_1 \\C_1 &\to C_4 \\C_2 &\to C_3 \\C_3 &\to C_2 \\C_4 &\to C_1
    \end{aligned}
    \quad
    \begin{aligned}[c]
    &\hspace{1mm}\varphi_2 \\
    A_1 &\to A_1 \\A_2 &\to A_3 \\A_3 &\to A_2 \\A_4 &\to A_4 \\B_1 &\to C_1 \\B_2 &\to C_3 \\B_3 &\to C_2 \\B_4 &\to C_4 \\C_1 &\to B_1 \\C_2 &\to B_3 \\C_3 &\to B_2 \\C_4 &\to B_4
    \end{aligned}
    \quad
    \begin{aligned}[c]
    &\hspace{1mm}\varphi_3 \\
    A_1 &\to C_1 \\A_2 &\to C_2 \\A_3 &\to C_3 \\A_4 &\to C_4 \\B_1 &\to A_1 \\B_2 &\to A_2 \\B_3 &\to A_3 \\B_4 &\to A_4 \\C_1 &\to B_1 \\C_2 &\to B_2 \\C_3 &\to B_3 \\C_4 &\to B_4
    \end{aligned}
    \quad
    \begin{aligned}[c]
    &\hspace{1mm}\varphi_4 \\
    A_1 &\to A_1 \\A_2 &\to A_2 \\A_3 &\to A_3 \\A_4 &\to A_4 \\B_1 &\to B_2 \\B_2 &\to B_1 \\B_3 &\to B_4 \\B_4 &\to B_3 \\C_1 &\to C_3 \\C_2 &\to C_4 \\C_3 &\to C_1 \\C_4 &\to C_2
    \end{aligned}
    \end{equation}
    % ((3, 2, 1, 0, 7, 6, 5, 4, 11, 10, 9, 8),
    %  (0, 2, 1, 3, 8, 10, 9, 11, 4, 6, 5, 7),
    %  (8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7),
    %  (0, 1, 2, 3, 5, 4, 7, 6, 10, 11, 8, 9))
    Notice that $\varphi_1, \varphi_2, \varphi_3, \varphi_4$ are all automorphisms of the web inflation. Moreover they stabilize the ai-expressible sets of \cref{tab:asexpr_triangle_structure_web}. Importantly,
    \[ \gp\br{\AIExpr[\graph]{\graph'}} \sim \Perm{A,B,C} \eq \]
    To see this, $\varphi_1$ and $\varphi_4$ become the identity element in $\Perm{A,B,C}$ upon removal of the copy-index, leaving $\varphi_2$ to generate reflections and $\varphi_3$ to generate rotations.

    The symmetric incidence matrix $M_{\Phi}$ for the Web inflation is considerably smaller than $M$. The number of rows of $M_{\Phi}$ is a number of distinct orbits $\Orb[\Phi]{m}$ in $\Events{\mscenario}$. Likewise the number of columns is the number of distinct orbits $\Orb[\Phi]{j}$ in $\Events{\jointvar}$. For the Web inflation in particular, $M_{\Phi}$ is $450 \times 358,120$. Using the symmetric incidence matrix and linear programing methods, an infeasibility certificate was found that is capable of witnessing the Fritz distribution. The corresponding deflated inequality is presented in \cref{sec:found_inequalities} as \cref{eq:symmetric_web_inequality}.

    % \section{Quantum Parameterization of Triangle structure}
    % \label{sec:param_quantum_dist}
    % \subsection{Unitary Group}
    % \label{sec:unitary_group}
    % To facilitate the parameterization of quantum states states and PVMs, a parameterization of the unitary group of dimension $d$ (denoted $\s{U}\br{d}$) by Spengler, Huber and Hiesmayr~\cite{Spengler_2010_Unitary} is introduced. Discussions of its application to states and measurements are deferred to \cref{sec:states} and \cref{sec:measurements} respectively.

    % In Ref.~\cite{Spengler_2010_Unitary}, Spengler \textit{et al.} proved that all unitaries $U \in \s{U}\br{d}$ can be parameterized without degeneracy as follows:
    % \[ U = \bs{\prod_{m=1}^{d-1} \br{\prod_{n=m+1}^{d} \exp\br{i P_n \lambda_{n,m}}\exp\br{i \si_{m,n} \lambda_{m,n}}}} \cdot \bs{\prod_{l=1}^{d} \exp\br{iP_l \lambda_{l,l}}}  \eq \label{eq:spengler_unitary_old} \]
    % Where $\la = \bc{\la_{n,m} \mid n,m \in 1, \ldots, d}$ form a $d \times d$ matrix of real-valued parameters with periodicities $\la_{m,n} \in \bs{0, \f{\pi}{2}}$ for $m < n$ and $\la_{m,n} \in \bs{0, 2 \pi}$ for $m \geq n$.
    % \[ \la = \begin{pmatrix}
    %     \la_{1,1} & \cdots & \la_{1, d} \\
    %     \vdots & \ddots & \vdots \\
    %     \la_{d,1} & \cdots & \la_{d, d} \\
    % \end{pmatrix} \]
    % And where $P_l$ are one-dimensional projective operators,
    % \[ P_l = \ket{l}\bra{l} \qquad 1 \leq l \leq d \eq \label{eq:projective_operator} \]
    % and the $\si_{m,n}$ are generalized anti-symmetric $\si$-matrices,
    % \[ \sigma_{m,n} = -i \ket{m}\bra{n} +i \ket{n}\bra{m} \qquad 1 \leq m < n \leq d\]
    % The SSH parameterization (\cref{eq:spengler_unitary}) is unique in that each of the real-valued parameters $\la_{n,m}$ has physical significance. For the sake of reference, let us label the matrix exponential terms in \cref{eq:spengler_unitary} in a manner that corresponds to their affect on an orthonormal basis $\bc{\ket{1}, \ldots, \ket{d}}$.
    % \begin{align*}
    % \begin{split}
    %     GP_l &= \exp\br{iP_l \lambda_{l,l}} \\
    %     RP_{n,m} &= \exp\br{i P_n \lambda_{n,m}} \\
    %     R_{m,n} &= \exp\br{i \si_{m,n} \lambda_{m,n}}
    % \end{split} \eq \label{eq:exp_terms}
    % \end{align*}
    % For example, $R_{m,n} = \exp\br{i \si_{m,n} \lambda_{m,n}}$ applies a rotation to the sub-space spanned by $\ket{m}$ and $\ket{n}$ for $m < n$. Analogously, $RP_{n,m}$ generates the relative phase between $\ket{m}$ and $\ket{n}$ for $m > n$ and $GP_l$ fixes the global phase of $\ket{l}$. Possessing a parameterization that maintains this physical interpretation is useful as it allows one to readily eliminate any degeneracies. For the purposes of quantum distributions such as \cref{eq:triangle_Qcompatibility}, it should be clear that any contributions to global phase are irrelevant. The SSH parameterization becomes especially attractive because it readily permits one to drop the global phase terms by setting $\la_{l,l} = 0$ for all $l = 1, \ldots, d$. It is convenient to denote the set of all unitaries up to global phase considerations as $\ti {\s{U}}\br{d}$ and express $\ti {U} \in \ti {\s{U}}\br{d}$ using $d\br{d-1}$ real-valued parameters:
    % \[ \ti U = \prod_{m=1}^{d-1} \br{\prod_{n=m+1}^{d} RP_{n,m}R_{m,n}} \eq \label{eq:spengler_unitary_gp} \]
    % Another attractive feature of the SSH parameterization not mentioned in~\cite{Spengler_2010_Unitary} is that \cref{eq:spengler_unitary}, and thus \cref{eq:spengler_unitary_gp}, can be implemented in a computationally efficient manner. This is discussed in \cref{sec:comp_spengler}.
    % \subsection{Measurements}
    % \label{sec:measurements}
    % For each measurement set $M$ in \cref{eq:triangle_Qcompatibility}, we consider a $d$-element projective-valued measure (PVM) $M = \bc{M_1, \ldots, M_d}$ satisfying a number of familiar constraints:
    % \begin{gather*}
    % \forall \ket{\phi} \in \Hilb^d: \bra{\phi} M_i \ket{\phi} \geq 0 \qquad \sum_{i=1}^{d} M_i = \ident_{d} \\
    % M_i = \ket{m_i}\bra{m_i} \qquad M_i M_j = \de_{ij} M_i
    % \end{gather*}
    % Therefore, parameterizing $M$ corresponds to parameterizing the set of all orthonormal basis $\bc{\ket{\psi_1}, \ldots, \ket{\psi_d}}$ of $\Hilb^d$.
    % First note that any such basis can be transformed into the computational basis $\bc{\ket{1}, \ldots, \ket{d}}$ by a unitary denoted $U^{-1} \in \mathcal{U}\br{d}$.
    % \[ \forall i : U^{-1} \ket{\psi_i} = \ket{i} \eq \label{eq:unitary_transform}\]
    % With this observation, all that is required is to parameterize the set of all unitaries $U \in \mathcal{U}\br{d}$. Specifically, the projective property each $M_i \in M$ means that the global phase of $U$ is completely arbitrary; one only needs to consider parameterizing unitaries up to global phase using \cref{eq:spengler_unitary_gp}.
    % \[ M = \bc{\ti U \ket{i} \bra{i} \ti U^{\dagger} \mid i \in \bc{1, \ldots, d}} \]
    % For the purposes discussed in \cref{sec:param_quantum_dist}, only $d = 4$ outcome measurements are utilized and therefore requiring $4\br{4 - 1} = 12$ real-valued parameters. This method was inspired by the measurement seeding method for iterative optimization used by \citet{Pal_2010} .
    % \subsection{States}
    % \label{sec:states}

    % Each state $\rho \in \br{\rho_{AB}, \rho_{BC}, \rho_{CA}}$ of \cref{eq:triangle_Qcompatibility} is modeled as a two-qubit density matrices acting on $\Hilb^2 \otimes \Hilb^2$. The space of all such states corresponds to the space of all $4\times 4$ positive semi-definite hermitian matrices with unitary trace.
    % \[ \forall \ket{\phi} \in \Hilb^d: \bra{\phi} \rho \ket{\phi} \geq 0 \qquad \rho^{\dagger} = \rho \qquad \Tr\br{\rho} = 1 \eq \label{eq:density_matrix}\]
    % Although is common to parameterize all such matrices using a Cholesky decomposition~\cite{Grasmair_2014}, we make use of the non-degenerate SHH parameterization~\cite{Spengler_2010_Unitary} and the spectral decomposition of $\rho$. Retaining full generality, consider full-rank density matrices:
    % \[ \rho = \sum_{i=1}^{d} p_i \ket{\psi_i}\bra{\psi_i} \qquad \sum_{i=1}^{d} p_i = 1, p_i \geq 0 \eq \label{eq:param_density} \]
    % Where $\bc{p_i}$ are the eigenvalues of $\rho$ and $\bc{\ket{\psi_i}}$ are its eigenstates. It is here that one recognizes the reapplication of \cref{eq:unitary_transform}: any orthonormal basis $\bc{\ket{\psi_i}}$ of $\Hilb^d$ can be transformed into a computational basis $\bc{\ket{i}}$ by a unitary transformation $U \in \mathcal{U}\br{d}$ such that $\ket{\psi_i} = U\ket{i}$. Analogous to the projective measurements considered in \cref{sec:measurements}, the global phase contributions are redundant.
    % \[ \rho = \sum_{i=1}^{d} p_i \ti U\ket{i}\bra{i} \ti U^{\dagger} \]
    % Parameterizing the eigenvalues requires $d - 1$ real-valued parameters due to the trace constraint of \cref{eq:density_matrix}. The eigenvalues are parameterized without degeneracy using a tuple of $d-1$ parameters $\lambda = \br{\lambda_1, \ldots, \lambda_{d-1}}, \lambda_i \in \bs{0, 2 \pi}$ using hyper-spherical coordinates~\cite{Hedemann_2013, Spengler_2010_Unitary}:
    % \begin{align*}
    % \eq \label{eq:convex_param}
    % \begin{split}
    %     p_n &= \prod_{i=1}^{n-1} \sin^2 \lambda_i \\
    %     p_j &= \cos^2 \lambda_j \prod_{i=1}^{j-1} \sin^2 \lambda_i \quad \forall j \in 1, \ldots, n - 1
    % \end{split}
    % \end{align*}

    % Furthermore due to the periodicity of the parameter space $\bc{\lambda}$, \cref{eq:convex_param} can be used for either constrained or unconstrained optimization problems. For continuity reasons, unconstrained optimizations are performed whenever possible. In conclusion, it is possible to parametrize all $d$-dimensional density matrices satisfying \cref{eq:density_matrix} using $d\br{d - 1} + d - 1 = d^2 -1$ real-valued parameters.

    % Although non-degenerate, \cref{eq:convex_param} suffers from a lack of uniformity; a randomly sampled vector of parameters $\bc{\lambda}$ \textit{does not} translate to a randomly sampled set of eigenvalues $\bc{p_i}$. Another, albeit degenerate, parameterization of $\bc{p_i}$ involves beginning with $d$ real parameters $\lambda = \br{\lambda_1, \ldots, \lambda_d}$, then forcing normalization by dividing each parameter $\la_i$ by the their sum.\footnote{Strictly speaking, \cref{eq:uniform_param} \textit{also} suffers from non-uniformity; being biased toward eigenvalues that have similar values to each other.}.
    % \[ p_j = \f{\abs{\lambda_j}}{\sum_{i=1}^{n} \abs{\lambda_i}} \quad \forall j \in 1, \ldots, n \eq \label{eq:uniform_param} \]
    % For various optimization tasks sensitive to initial conditions outlined \cref{sec:optimizations}, the latter parameterization of \cref{eq:uniform_param} generally performed better than the former \cref{eq:convex_param}.
    % % \subsection{Permutation Matrix}
    % % \label{sec:perm_matrix}
    % % \begin{figure}
    % %     \centering
    % %     \includegraphics[trim={1cm 1.2cm 1.0cm 1cm},clip,width=0.4\textwidth]{figures/perm_mtrx.pdf}
    % %     \caption{The permutation matrix $\netperm$ acting on $\br{\Hilb^2}^{\otimes 6}$ for the Triangle structure. Black entries represents a value of $1$ and white represents $0$.}
    % %     \label{fig:perm_mtrx}
    % % \end{figure}
    % % Finally, we introduce the a permutation matrix $\netperm$ for the Triangle structure. For bipartite qubit states, $\netperm$ is the $64\times64$ bit-wise matrix depicted in \cref{fig:perm_mtrx}. Upon examination of \cref{eq:quantum_model_triangle_pvms}, we consider $\netperm$ to be acting on the joint global state $\rho_{{AB}} \otimes \rho_{{BC}} \otimes \rho_{{CA}}$. To illuminate its necessity, consider \cref{eq:triangle_Qcompatibility} in the absence of $\netperm$.
    % % \begin{align*}
    % % \prob[{ABC}]\br{abc} &\stackrel{?}{=} \Tr\bs{\br{\rho_{{AB}} \otimes \rho_{{BC}} \otimes \rho_{{CA}}} \br{M^a_{{A}}\otimes M^b_{{B}} \otimes M^c_{{C}}}}\\
    % % &= \Tr\bs{\br{\rho_{{AB}}M^a_{{A}}}\otimes\br{\rho_{{BC}}M^b_{{B}}}\otimes\br{\rho_{{CA}}M^c_{{C}}}}\\
    % % &= \Tr\br{\rho_{{AB}}M^a_{{A}}}\Tr\br{\rho_{{BC}}M^b_{{B}}}\Tr\br{\rho_{{CA}}M^c_{{C}}}\\
    % % &= \prob[{A}\mid \rho_{{AB}}]\br{a}\prob[{B}\mid \rho_{{BC}}]\br{b}\prob[{C}\mid \rho_{{CA}}]\br{c}
    % % \end{align*}
    % % On an operational level, this corresponds to $A$ making a measurement on \textit{both} subsystems of $\rho_{AB}$ and \textit{not} on any component of $\rho_{CA}$. This is analogously troubling for $B$ and $C$ as well. To resolve this issue, the permutation matrix $\netperm$ corresponds to \textit{aligning} the underlying $6$-qubit joint state $\rho$ with the joint measurement $M$. To understand its effect, consider its effect on $6$-qubit pure state $\ket{q_1} \otimes \cdots \otimes \ket{q_6} = \ket{q_1q_2q_3q_4q_5q_6}$ where $\forall i : \ket{q_i} \in \Hilb^2$.
    % % \[ \netperm\ket{q_1q_2q_3q_4q_5q_6} = \ket{q_2q_3q_4q_5q_6q_1} \]
    % % $\netperm$ acts as a \textit{partial transpose} on $\br{\Hilb^2}^{\otimes 6}$ by shifting the underlying tensor structure one subsystem to the ``left''. It is uniquely defined by its action on all $2^6$ orthonormal basis elements of $\br{\Hilb^2}^{\otimes 6}$,
    % % \[ \netperm \defined \sum_{\ket{q_i} \in \bc{\ket{0}, \ket{1}}}\ket{q_2q_3q_4q_5q_6q_1}\bra{q_1q_2q_3q_4q_5q_6} \]
    % \subsection{Computationally Efficient Parameterization of the Unitary Group}
    % \label{sec:comp_spengler}

    % If \cref{sec:unitary_group}, the SSH parameterization was introduced as a non-degenerate parameterization of the unitary group $\s{U}\br{d}$. As presented, the SSH parameterization suffers due to the presence of computationally expensive matrix exponential terms~\cite{Moler_2003}. Although not explicitly mentioned in~\cite{Spengler_2010_Unitary}, it is possible to remove the reliance on matrix exponential operations in \cref{eq:spengler_unitary} by utilizing the explicit form of the exponential terms in \cref{eq:exp_terms}. As a first step, recognize the defining property of the projective operators \cref{eq:projective_operator},
    % \[ P_l^k = \br{\ket{l}\bra{l}}^k = \ket{l}\bra{l} = P_l \]
    % This greatly simplifies the global phase terms $GP_l$,
    % \[ GP_l = \exp\br{iP_l \lambda_{l,l}} = \sum_{k=0}^{\inf} \f{\br{iP_l \lambda_{l,l}}^k}{k!} = \ident + \sum_{k=1}^{\inf} \f{\br{i \lambda_{l,l}}^k}{k!}P_l^k = \ident + P_l \bs{\sum_{k=1}^{\inf} \f{\br{i \lambda_{l,l}}^k}{k!}} = \ident + P_l \br{e^{i \lambda_{l,l}} - 1} \eq \label{eq:unitary_GP} \]
    % Analogously for the relative phase terms $RP_{n,m}$,
    % \[ RP_{n,m} = \cdots = \ident + P_n \br{e^{i \lambda_{n,m}} - 1} \eq \label{eq:unitary_RP} \]
    % Finally, the rotation terms $R_{m,n}$ can also be simplified by examining powers of $i \sigma_{n,m}$,
    % \[ R_{m,n} = \exp\br{i \si_{m,n} \lambda_{m,n}} = \sum_{k=0}^{\inf} \f{\br{\ket{m}\bra{n} - \ket{n}\bra{m}}^k \lambda_{m,n}^k}{k!} \]
    % One can verify that the following properties hold,
    % \begin{align*}
    %     \br{\ket{m}\bra{n} - \ket{n}\bra{m}}^0 &= \ident \\
    %     \forall k \in \N, k \neq 0 : \br{\ket{m}\bra{n} - \ket{n}\bra{m}}^{2k} &= \br{-1}^k\br{\ket{m}\bra{m} + \ket{n}\bra{n}} \\
    %     \forall k \in \N : \br{\ket{m}\bra{n} - \ket{n}\bra{m}}^{2k+1} &= \br{-1}^k\br{\ket{m}\bra{n} - \ket{n}\bra{m}}
    % \end{align*}
    % Revealing the simplified form of $R_{m,n}$,
    % \[ R_{m,n} = \ident + \br{\ket{m}\bra{m} + \ket{n}\bra{n}} \sum_{j=1}^{\inf} \br{-1}^j\f{\lambda_{n,m}^{2j}}{\br{2j}!} + \br{\ket{m}\bra{n} - \ket{n}\bra{m}} \sum_{j=0}^{\inf} \br{-1}^j\f{\lambda_{n,m}^{2j+1}}{\br{2j+1}!} \]
    % \[ R_{m,n} = \ident + \br{\ket{m}\bra{m} + \ket{n}\bra{n}} \br{\cos\lambda_{n,m} - 1} + \br{\ket{m}\bra{n} - \ket{n}\bra{m}} \sin\lambda_{n,m} \eq \label{eq:unitary_R} \]
    % By combining the optimizations of \cref{eq:unitary_GP,eq:unitary_RP,eq:unitary_R} together we arrive at an equivalent form for \cref{eq:spengler_unitary} that is computational more efficient.
    % \[ U = \bs{\prod_{m=1}^{d-1} \br{\prod_{n=m+1}^{d} R_{m,n}RP_{n,m}}} \cdot \bs{\prod_{l=1}^{d} GP_{l}}  \eq \label{eq:spengler_unitary_fast} \]

    \setlength{\bibsep}{3pt plus 3pt minus 2pt}
    \bibliographystyle{apsrev4-1}
    \nocite{apsrev41Control}
    \bibliography{references}

\end{document}